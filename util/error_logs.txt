2025-04-08 21:17:29 [ERROR]: Starting CSV export process
2025-04-08 21:17:29 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-08 21:17:29 [ERROR]: Added missing column: Place_of_Creation
2025-04-08 21:17:29 [ERROR]: Added missing column: Text
2025-04-08 21:17:29 [ERROR]: Using Current Display as the source for text data
2025-04-08 21:17:29 [ERROR]: Actual text source column identified as: Current Display
2025-04-08 21:17:32 [ERROR]: Using metadata headers from preset 'Standard Metadata': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-08 21:17:32 [ERROR]: Added essential column: Creation_Place
2025-04-08 21:17:32 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-08 21:17:32 [ERROR]: Copied 8 values for column: Document_Type
2025-04-08 21:17:32 [ERROR]: Copied 8 values for column: Author
2025-04-08 21:17:32 [ERROR]: Copied 8 values for column: Correspondent
2025-04-08 21:17:32 [ERROR]: Copied 8 values for column: Correspondent_Place
2025-04-08 21:17:32 [ERROR]: Copied 8 values for column: Date
2025-04-08 21:17:32 [ERROR]: Copied 8 values for column: Place_of_Creation
2025-04-08 21:17:32 [ERROR]: Copied 8 values for column: People
2025-04-08 21:17:32 [ERROR]: Copied 8 values for column: Places
2025-04-08 21:17:32 [ERROR]: Copied 8 values for column: Summary
2025-04-08 21:17:32 [ERROR]: Copied 8 values for column: Creation_Place
2025-04-08 21:17:32 [ERROR]: Preparing export dataframe. Text source: Current Display
2025-04-08 21:17:32 [ERROR]: Using 'Current Display' for text - applying find_right_text
2025-04-08 21:17:32 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-08 21:17:32 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Original_Text']
2025-04-08 21:23:52 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-08 21:23:55 [ERROR]: Starting CSV export process
2025-04-08 21:23:55 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-08 21:23:55 [ERROR]: Added missing column: Place_of_Creation
2025-04-08 21:23:55 [ERROR]: Added missing column: Text
2025-04-08 21:23:55 [ERROR]: Using Original_Text as the source for text data
2025-04-08 21:23:55 [ERROR]: Actual text source column identified as: Original_Text
2025-04-08 21:23:55 [ERROR]: Critical error in metadata generation: name 'actual_text_source_column' is not defined
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 633, in _generate_metadata
    export_text_source=actual_text_source_column # Pass resolved source column
                       ^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'actual_text_source_column' is not defined
2025-04-08 21:23:55 [ERROR]: Traceback: Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 633, in _generate_metadata
    export_text_source=actual_text_source_column # Pass resolved source column
                       ^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'actual_text_source_column' is not defined

Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 633, in _generate_metadata
    export_text_source=actual_text_source_column # Pass resolved source column
                       ^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'actual_text_source_column' is not defined
2025-04-08 21:23:56 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-08 21:23:56 [ERROR]: Using column 'Original_Text' for text
2025-04-08 21:23:56 [ERROR]: Dropped original text source column: Original_Text
2025-04-08 21:23:56 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-08 21:23:56 [ERROR]: 'Original_Text' column is missing before final ordering.
2025-04-08 21:23:56 [ERROR]: CRITICAL: 'Original_Text' column missing in final export list!
2025-04-08 21:23:56 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-08 21:25:11 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-08 21:25:14 [ERROR]: Starting CSV export process
2025-04-08 21:25:14 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-08 21:25:14 [ERROR]: Added missing column: Place_of_Creation
2025-04-08 21:25:14 [ERROR]: Added missing column: Text
2025-04-08 21:25:14 [ERROR]: Using Original_Text as the source for text data
2025-04-08 21:25:14 [ERROR]: Actual text source column identified as: Original_Text
2025-04-08 21:26:05 [ERROR]: Critical error in metadata generation: cannot access local variable 'job_params' where it is not associated with a value
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 634, in _generate_metadata
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 493, in ai_function
    self.last_used_metadata_preset = job_params.get('preset_name_used', None)
                                     ^^^^^^^^^^
UnboundLocalError: cannot access local variable 'job_params' where it is not associated with a value
2025-04-08 21:26:05 [ERROR]: Traceback: Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 634, in _generate_metadata
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 493, in ai_function
    self.last_used_metadata_preset = job_params.get('preset_name_used', None)
                                     ^^^^^^^^^^
UnboundLocalError: cannot access local variable 'job_params' where it is not associated with a value

Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 634, in _generate_metadata
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 493, in ai_function
    self.last_used_metadata_preset = job_params.get('preset_name_used', None)
                                     ^^^^^^^^^^
UnboundLocalError: cannot access local variable 'job_params' where it is not associated with a value
2025-04-08 21:26:05 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-08 21:26:05 [ERROR]: Using column 'Original_Text' for text
2025-04-08 21:26:05 [ERROR]: Dropped original text source column: Original_Text
2025-04-08 21:26:05 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-08 21:26:05 [ERROR]: 'Original_Text' column is missing before final ordering.
2025-04-08 21:26:05 [ERROR]: CRITICAL: 'Original_Text' column missing in final export list!
2025-04-08 21:26:05 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-08 21:26:23 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-08 21:26:28 [ERROR]: Starting CSV export process
2025-04-08 21:26:28 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-08 21:26:28 [ERROR]: Added missing column: Place_of_Creation
2025-04-08 21:26:28 [ERROR]: Added missing column: Text
2025-04-08 21:26:28 [ERROR]: Using resolved text source column: Original_Text
2025-04-08 21:26:29 [ERROR]: Critical error in metadata generation: cannot access local variable 'job_params' where it is not associated with a value
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 623, in _generate_metadata
    self.app.ai_functions_handler.ai_function(
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 493, in ai_function
    self.last_used_metadata_preset = job_params.get('preset_name_used', None)
                                     ^^^^^^^^^^
UnboundLocalError: cannot access local variable 'job_params' where it is not associated with a value
2025-04-08 21:26:29 [ERROR]: Traceback: Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 623, in _generate_metadata
    self.app.ai_functions_handler.ai_function(
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 493, in ai_function
    self.last_used_metadata_preset = job_params.get('preset_name_used', None)
                                     ^^^^^^^^^^
UnboundLocalError: cannot access local variable 'job_params' where it is not associated with a value

Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 623, in _generate_metadata
    self.app.ai_functions_handler.ai_function(
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 493, in ai_function
    self.last_used_metadata_preset = job_params.get('preset_name_used', None)
                                     ^^^^^^^^^^
UnboundLocalError: cannot access local variable 'job_params' where it is not associated with a value
2025-04-08 21:26:29 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-08 21:26:29 [ERROR]: Using column 'Original_Text' for text
2025-04-08 21:26:29 [ERROR]: Dropped original text source column: Original_Text
2025-04-08 21:26:29 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-08 21:26:29 [ERROR]: 'Original_Text' column is missing before final ordering.
2025-04-08 21:26:29 [ERROR]: CRITICAL: 'Original_Text' column missing in final export list!
2025-04-08 21:26:29 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-08 21:29:19 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-08 21:29:22 [ERROR]: Starting CSV export process
2025-04-08 21:29:22 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-08 21:29:22 [ERROR]: Added missing column: Place_of_Creation
2025-04-08 21:29:22 [ERROR]: Added missing column: Text
2025-04-08 21:29:22 [ERROR]: Using resolved text source column: Original_Text
2025-04-08 21:29:24 [ERROR]: Using metadata headers from preset 'Standard Metadata': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-08 21:29:24 [ERROR]: Added essential column: Creation_Place
2025-04-08 21:29:24 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-08 21:29:24 [ERROR]: Copied 8 values for column: Document_Type
2025-04-08 21:29:24 [ERROR]: Copied 8 values for column: Author
2025-04-08 21:29:24 [ERROR]: Copied 8 values for column: Correspondent
2025-04-08 21:29:24 [ERROR]: Copied 8 values for column: Correspondent_Place
2025-04-08 21:29:24 [ERROR]: Copied 8 values for column: Date
2025-04-08 21:29:24 [ERROR]: Copied 8 values for column: Place_of_Creation
2025-04-08 21:29:24 [ERROR]: Copied 8 values for column: People
2025-04-08 21:29:24 [ERROR]: Copied 8 values for column: Places
2025-04-08 21:29:24 [ERROR]: Copied 8 values for column: Summary
2025-04-08 21:29:24 [ERROR]: Copied 8 values for column: Creation_Place
2025-04-08 21:29:24 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-08 21:29:24 [ERROR]: Using column 'Original_Text' for text
2025-04-08 21:29:24 [ERROR]: Dropped original text source column: Original_Text
2025-04-08 21:29:24 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-08 21:29:24 [ERROR]: 'Original_Text' column is missing before final ordering.
2025-04-08 21:29:24 [ERROR]: CRITICAL: 'Original_Text' column missing in final export list!
2025-04-08 21:29:24 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-08 21:29:49 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-08 21:29:53 [ERROR]: Starting CSV export process
2025-04-08 21:29:53 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-08 21:29:53 [ERROR]: Added missing column: Place_of_Creation
2025-04-08 21:29:53 [ERROR]: Added missing column: Text
2025-04-08 21:29:53 [ERROR]: Using resolved text source column: Original_Text
2025-04-08 21:30:01 [ERROR]: Using metadata headers from preset 'Standard Metadata': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-08 21:30:01 [ERROR]: Added essential column: Creation_Place
2025-04-08 21:30:01 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-08 21:30:01 [ERROR]: Copied 8 values for column: Document_Type
2025-04-08 21:30:01 [ERROR]: Copied 8 values for column: Author
2025-04-08 21:30:01 [ERROR]: Copied 8 values for column: Correspondent
2025-04-08 21:30:01 [ERROR]: Copied 8 values for column: Correspondent_Place
2025-04-08 21:30:01 [ERROR]: Copied 8 values for column: Date
2025-04-08 21:30:01 [ERROR]: Copied 8 values for column: Place_of_Creation
2025-04-08 21:30:01 [ERROR]: Copied 8 values for column: People
2025-04-08 21:30:01 [ERROR]: Copied 8 values for column: Places
2025-04-08 21:30:01 [ERROR]: Copied 8 values for column: Summary
2025-04-08 21:30:01 [ERROR]: Copied 8 values for column: Creation_Place
2025-04-08 21:30:01 [ERROR]: Single author specified: Jhn Cobb
2025-04-08 21:30:01 [ERROR]: Citation specified: HBCA
2025-04-08 21:30:01 [ERROR]: Starting date and place analysis sequence using preset: Sequence_Dates
2025-04-08 21:30:01 [ERROR]: Using required headers from sequential preset: ['Date', 'Place']
2025-04-08 21:30:01 [ERROR]: Clearing existing values for fresh date analysis
2025-04-08 21:30:01 [ERROR]: Copied existing Date values from compiled_df to date_df
2025-04-08 21:30:01 [ERROR]: Added legacy Creation_Place column to date_df
2025-04-08 21:30:01 [ERROR]: Created date analysis dataframe with 8 rows and columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-08 21:30:01 [ERROR]: Using specified sequential preset: Sequence_Dates
2025-04-08 21:30:01 [ERROR]: Found required headers in sequence preset: ['Date', 'Place']
2025-04-08 21:30:01 [ERROR]: Setting active sequential preset to: Sequence_Dates
2025-04-08 21:30:22 [ERROR]: Date analysis result dataframe has columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-08 21:30:22 [ERROR]: Date analysis result dataframe has 8 rows
2025-04-08 21:30:22 [ERROR]: Date analysis found 8 dates
2025-04-08 21:30:22 [ERROR]: Date analysis found 8 Date values
2025-04-08 21:30:22 [ERROR]: Date analysis found 8 Place values
2025-04-08 21:30:22 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': 'A Journal of Transactions at\nAsh Fall by Mr John Cobb\n1', 'Date': 'YYYY/MM/DD', 'Place': 'Ash Fall', 'Creation_Place': 'Ash Fall'}
2025-04-08 21:30:22 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': '1798.\nAugt 2 Thursday Wind Westerly clear pleasant weather at 2 P. M.\nI set off from Martins Fall with two Boats for Osnaburgh\nHouse and arrived at that place the 19 Inst.', 'Date': '1798/08/02', 'Place': 'Martins Fall', 'Creation_Place': 'Martins Fall'}
2025-04-08 21:30:22 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '20 Monday Wind N Wst with rain all day in the evening\nMr McKay arrived from Martins Fall with 3 Boats', 'Date': '1798/08/20', 'Place': 'Osnaburgh House', 'Creation_Place': 'Osnaburgh House'}
2025-04-08 21:30:22 [ERROR]: Date analysis returned dataframe with columns: Page, Text, Date, Place, Creation_Place
2025-04-08 21:30:22 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': 'A Journal of Transactions at\nAsh Fall by Mr John Cobb\n1', 'Date': 'YYYY/MM/DD', 'Place': 'Ash Fall', 'Creation_Place': 'Ash Fall'}
2025-04-08 21:30:22 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': '1798.\nAugt 2 Thursday Wind Westerly clear pleasant weather at 2 P. M.\nI set off from Martins Fall with two Boats for Osnaburgh\nHouse and arrived at that place the 19 Inst.', 'Date': '1798/08/02', 'Place': 'Martins Fall', 'Creation_Place': 'Martins Fall'}
2025-04-08 21:30:22 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '20 Monday Wind N Wst with rain all day in the evening\nMr McKay arrived from Martins Fall with 3 Boats', 'Date': '1798/08/20', 'Place': 'Osnaburgh House', 'Creation_Place': 'Osnaburgh House'}
2025-04-08 21:30:22 [ERROR]: Using specified sequential preset for copying results: Sequence_Dates
2025-04-08 21:30:22 [ERROR]: Copying required headers from sequence preset: ['Date', 'Place']
2025-04-08 21:30:22 [ERROR]: Added missing Place column to compiled_df before copying results
2025-04-08 21:30:22 [ERROR]: Updated fields in the compiled dataframe: 8 Date, 8 Place, 8 Place_of_Creation, 8 Creation_Place
2025-04-08 21:30:22 [ERROR]: Sequential preset headers: ['Date', 'Place']
2025-04-08 21:30:22 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-08 21:30:22 [ERROR]: Using column 'Original_Text' for text
2025-04-08 21:30:22 [ERROR]: Dropped original text source column: Original_Text
2025-04-08 21:30:22 [ERROR]: Overriding 'Author' column with single author: Jhn Cobb
2025-04-08 21:30:22 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-08 21:30:22 [ERROR]: Adding/overwriting with sequential headers: ['Date', 'Place']
2025-04-08 21:30:22 [ERROR]: 'Original_Text' column is missing before final ordering.
2025-04-08 21:30:22 [ERROR]: Adding 'Citation' column.
2025-04-08 21:30:22 [ERROR]: CRITICAL: 'Original_Text' column missing in final export list!
2025-04-08 21:30:22 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Place', 'Citation']
2025-04-08 22:09:19 [ERROR]: Critical error in collate_names_and_places: '_tkinter.tkapp' object has no attribute 'parse_collation_response'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 861, in collate_names_and_places
    names_dict = self.app.parse_collation_response(self.collated_names_raw)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'parse_collation_response'
2025-04-09 18:59:18 [ERROR]: Process edited image error: [WinError 183] Cannot create a file when that file already exists: 'd:\\TranscriptionPearl\\util\\temp\\images\\temp_0_0.jpg' -> 'd:\\TranscriptionPearl\\util\\temp\\images\\0001_p001.jpg'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\DataOperations.py", line 572, in process_edited_single_image
    os.rename(old_temp_path_abs, final_image_path_abs)
FileExistsError: [WinError 183] Cannot create a file when that file already exists: 'd:\\TranscriptionPearl\\util\\temp\\images\\temp_0_0.jpg' -> 'd:\\TranscriptionPearl\\util\\temp\\images\\0001_p001.jpg'
2025-04-09 19:00:29 [ERROR]: Process edited image error: [WinError 183] Cannot create a file when that file already exists: 'd:\\TranscriptionPearl\\util\\temp\\images\\temp_0_0.jpg' -> 'd:\\TranscriptionPearl\\util\\temp\\images\\0001_p001.jpg'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\DataOperations.py", line 572, in process_edited_single_image
    os.rename(old_temp_path_abs, final_image_path_abs)
FileExistsError: [WinError 183] Cannot create a file when that file already exists: 'd:\\TranscriptionPearl\\util\\temp\\images\\temp_0_0.jpg' -> 'd:\\TranscriptionPearl\\util\\temp\\images\\0001_p001.jpg'
2025-04-09 19:36:46 [ERROR]: Process edited image error: [WinError 183] Cannot create a file when that file already exists: 'd:\\TranscriptionPearl\\util\\temp\\images\\temp_0_0.jpg' -> 'd:\\TranscriptionPearl\\util\\temp\\images\\0001_p001.jpg'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\DataOperations.py", line 572, in process_edited_single_image
    os.rename(old_temp_path_abs, final_image_path_abs)
FileExistsError: [WinError 183] Cannot create a file when that file already exists: 'd:\\TranscriptionPearl\\util\\temp\\images\\temp_0_0.jpg' -> 'd:\\TranscriptionPearl\\util\\temp\\images\\0001_p001.jpg'
2025-04-09 19:40:21 [ERROR]: Error in edit_all_images: name 'natural_sort_key' is not defined
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 2431, in edit_all_images
    key=natural_sort_key # Sort naturally
        ^^^^^^^^^^^^^^^^
NameError: name 'natural_sort_key' is not defined
2025-04-09 22:17:14 [ERROR]: Error in ai_function orchestration for job Get_Names_and_Places: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 393, in ai_function
    text_to_process = self.app.data_operations.find_right_text(index) # Use best available text
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:18:10 [ERROR]: Error checking for document separators: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\SeparateDocuments.py", line 146, in apply_document_separation
    text = app.find_right_text(index)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:22:17 [ERROR]: Error in compile_documents: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\CompileDocuments.py", line 134, in compile_documents
    text_content = self.parent.find_right_text(index).strip()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:22:17 [ERROR]: Error applying document separation: No documents were found after separation. Check that your separators are correct.
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\SeparateDocuments.py", line 189, in apply_document_separation
    raise Exception("No documents were found after separation. Check that your separators are correct.")
Exception: No documents were found after separation. Check that your separators are correct.
2025-04-09 22:24:23 [ERROR]: Critical error in get_images_for_job at index 0: _path_exists: path should be string, bytes, os.PathLike or integer, not list
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 683, in get_images_for_job
    if not current_image_abs or not os.path.exists(current_image_abs):
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: _path_exists: path should be string, bytes, os.PathLike or integer, not list
2025-04-09 22:32:13 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-09 22:32:17 [ERROR]: Starting CSV export process
2025-04-09 22:32:17 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-09 22:32:17 [ERROR]: Added missing column: Place_of_Creation
2025-04-09 22:32:17 [ERROR]: Added missing column: Text
2025-04-09 22:32:17 [ERROR]: Using resolved text source column: Original_Text
2025-04-09 22:32:23 [ERROR]: Using metadata headers from preset 'damn it': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-09 22:32:23 [ERROR]: Added essential column: Creation_Place
2025-04-09 22:32:23 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-09 22:32:23 [ERROR]: Copied 14 values for column: Document_Type
2025-04-09 22:32:23 [ERROR]: Copied 14 values for column: Author
2025-04-09 22:32:23 [ERROR]: Copied 14 values for column: Correspondent
2025-04-09 22:32:23 [ERROR]: Copied 14 values for column: Correspondent_Place
2025-04-09 22:32:23 [ERROR]: Copied 14 values for column: Date
2025-04-09 22:32:23 [ERROR]: Copied 14 values for column: Place_of_Creation
2025-04-09 22:32:23 [ERROR]: Copied 14 values for column: People
2025-04-09 22:32:23 [ERROR]: Copied 14 values for column: Places
2025-04-09 22:32:23 [ERROR]: Copied 14 values for column: Summary
2025-04-09 22:32:23 [ERROR]: Copied 14 values for column: Creation_Place
2025-04-09 22:32:23 [ERROR]: Starting date and place analysis sequence using preset: Sequence_Dates
2025-04-09 22:32:23 [ERROR]: Using required headers from sequential preset: ['Date', 'Place']
2025-04-09 22:32:23 [ERROR]: Clearing existing values for fresh date analysis
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 0: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 1: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 2: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 3: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 4: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 5: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 6: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 7: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 8: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 9: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 10: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 11: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 12: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Error getting text for date analysis at idx 13: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:32:23 [ERROR]: Copied existing Date values from compiled_df to date_df
2025-04-09 22:32:23 [ERROR]: Added legacy Creation_Place column to date_df
2025-04-09 22:32:23 [ERROR]: Created date analysis dataframe with 14 rows and columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-09 22:32:23 [ERROR]: Using specified sequential preset: Sequence_Dates
2025-04-09 22:32:23 [ERROR]: Found required headers in sequence preset: ['Date', 'Place']
2025-04-09 22:32:23 [ERROR]: Error in asyncio loop: 'APIHandler' object has no attribute 'parent'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 1008, in _run_date_analysis
    result = loop.run_until_complete(process_with_progress())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\asyncio\base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 996, in process_with_progress
    analyzer = DateAnalyzer(api_handler, self.app.settings)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\AnalyzeDate.py", line 17, in __init__
    self.parent_app = api_handler.parent
                      ^^^^^^^^^^^^^^^^^^
AttributeError: 'APIHandler' object has no attribute 'parent'
2025-04-09 22:32:23 [ERROR]: Traceback: Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 1008, in _run_date_analysis
    result = loop.run_until_complete(process_with_progress())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\asyncio\base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 996, in process_with_progress
    analyzer = DateAnalyzer(api_handler, self.app.settings)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\AnalyzeDate.py", line 17, in __init__
    self.parent_app = api_handler.parent
                      ^^^^^^^^^^^^^^^^^^
AttributeError: 'APIHandler' object has no attribute 'parent'

Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 1008, in _run_date_analysis
    result = loop.run_until_complete(process_with_progress())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\asyncio\base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 996, in process_with_progress
    analyzer = DateAnalyzer(api_handler, self.app.settings)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\AnalyzeDate.py", line 17, in __init__
    self.parent_app = api_handler.parent
                      ^^^^^^^^^^^^^^^^^^
AttributeError: 'APIHandler' object has no attribute 'parent'
2025-04-09 22:32:23 [ERROR]: Sequential preset headers: ['Date', 'Place']
2025-04-09 22:32:23 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-09 22:32:23 [ERROR]: Using column 'Original_Text' for text
2025-04-09 22:32:23 [ERROR]: Dropped original text source column: Original_Text
2025-04-09 22:32:23 [ERROR]: Metadata headers from preset 'damn it': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-09 22:32:23 [ERROR]: Adding/overwriting with sequential headers: ['Date', 'Place']
2025-04-09 22:32:23 [ERROR]: Sequential header 'Place' not found in compiled data.
2025-04-09 22:32:23 [ERROR]: 'Original_Text' column is missing before final ordering.
2025-04-09 22:32:23 [ERROR]: CRITICAL: 'Original_Text' column missing in final export list!
2025-04-09 22:32:23 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-09 22:32:42 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-09 22:35:41 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-09 22:35:45 [ERROR]: Starting CSV export process
2025-04-09 22:35:45 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-09 22:35:45 [ERROR]: Added missing column: Place_of_Creation
2025-04-09 22:35:45 [ERROR]: Added missing column: Text
2025-04-09 22:35:45 [ERROR]: Using resolved text source column: Original_Text
2025-04-09 22:35:54 [ERROR]: Using metadata headers from preset 'damn it': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-09 22:35:54 [ERROR]: Added essential column: Creation_Place
2025-04-09 22:35:54 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-09 22:35:54 [ERROR]: Copied 14 values for column: Document_Type
2025-04-09 22:35:54 [ERROR]: Copied 14 values for column: Author
2025-04-09 22:35:54 [ERROR]: Copied 14 values for column: Correspondent
2025-04-09 22:35:54 [ERROR]: Copied 14 values for column: Correspondent_Place
2025-04-09 22:35:54 [ERROR]: Copied 14 values for column: Date
2025-04-09 22:35:54 [ERROR]: Copied 14 values for column: Place_of_Creation
2025-04-09 22:35:54 [ERROR]: Copied 14 values for column: People
2025-04-09 22:35:54 [ERROR]: Copied 14 values for column: Places
2025-04-09 22:35:54 [ERROR]: Copied 14 values for column: Summary
2025-04-09 22:35:54 [ERROR]: Copied 14 values for column: Creation_Place
2025-04-09 22:35:54 [ERROR]: Starting date and place analysis sequence using preset: Sequence_Dates
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Error getting text for date analysis at idx None: '>=' not supported between instances of 'NoneType' and 'int'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 808, in _analyze_dates_sequentially
    text_for_date = self.app.data_operations.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\DataOperations.py", line 60, in find_right_text
    if self.app.main_df.empty or index_no >= len(self.app.main_df):
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>=' not supported between instances of 'NoneType' and 'int'
2025-04-09 22:35:54 [ERROR]: Date and place analysis failed: name 'sequence_preset' is not defined
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 835, in _analyze_dates_sequentially
    preset_name = sequence_preset.get('name', "Sequence_Dates") if sequence_preset else "Sequence_Dates"
                                                                   ^^^^^^^^^^^^^^^
NameError: name 'sequence_preset' is not defined
2025-04-09 22:37:22 [ERROR]: Sequential preset headers: ['Date', 'Place']
2025-04-09 22:37:22 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-09 22:37:22 [ERROR]: Using column 'Original_Text' for text
2025-04-09 22:37:22 [ERROR]: Dropped original text source column: Original_Text
2025-04-09 22:37:22 [ERROR]: Metadata headers from preset 'damn it': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-09 22:37:22 [ERROR]: Adding/overwriting with sequential headers: ['Date', 'Place']
2025-04-09 22:37:22 [ERROR]: Sequential header 'Place' not found in compiled data.
2025-04-09 22:37:22 [ERROR]: 'Original_Text' column is missing before final ordering.
2025-04-09 22:37:22 [ERROR]: CRITICAL: 'Original_Text' column missing in final export list!
2025-04-09 22:37:22 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-09 22:38:17 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-09 22:38:21 [ERROR]: Starting CSV export process
2025-04-09 22:38:21 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-09 22:38:21 [ERROR]: Added missing column: Place_of_Creation
2025-04-09 22:38:21 [ERROR]: Added missing column: Text
2025-04-09 22:38:21 [ERROR]: Using resolved text source column: Original_Text
2025-04-09 22:38:26 [ERROR]: Using metadata headers from preset 'damn it': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-09 22:38:26 [ERROR]: Added essential column: Creation_Place
2025-04-09 22:38:26 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-09 22:38:26 [ERROR]: Copied 14 values for column: Document_Type
2025-04-09 22:38:26 [ERROR]: Copied 14 values for column: Author
2025-04-09 22:38:26 [ERROR]: Copied 14 values for column: Correspondent
2025-04-09 22:38:26 [ERROR]: Copied 14 values for column: Correspondent_Place
2025-04-09 22:38:26 [ERROR]: Copied 14 values for column: Date
2025-04-09 22:38:26 [ERROR]: Copied 14 values for column: Place_of_Creation
2025-04-09 22:38:26 [ERROR]: Copied 14 values for column: People
2025-04-09 22:38:26 [ERROR]: Copied 14 values for column: Places
2025-04-09 22:38:26 [ERROR]: Copied 14 values for column: Summary
2025-04-09 22:38:26 [ERROR]: Copied 14 values for column: Creation_Place
2025-04-09 22:38:26 [ERROR]: Starting date and place analysis sequence using preset: Sequence_Dates
2025-04-09 22:38:26 [ERROR]: Using sequential preset: Sequence_Dates
2025-04-09 22:38:26 [ERROR]: Date and place analysis failed: name 'loop' is not defined
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 887, in _analyze_dates_sequentially
    result = loop.run_until_complete(process_with_progress())
             ^^^^
NameError: name 'loop' is not defined
2025-04-09 22:38:28 [ERROR]: Sequential preset headers: ['Date', 'Place']
2025-04-09 22:38:28 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-09 22:38:28 [ERROR]: Using column 'Original_Text' for text
2025-04-09 22:38:28 [ERROR]: Dropped original text source column: Original_Text
2025-04-09 22:38:28 [ERROR]: Metadata headers from preset 'damn it': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-09 22:38:28 [ERROR]: Adding/overwriting with sequential headers: ['Date', 'Place']
2025-04-09 22:38:28 [ERROR]: Sequential header 'Place' not found in compiled data.
2025-04-09 22:38:28 [ERROR]: 'Original_Text' column is missing before final ordering.
2025-04-09 22:38:28 [ERROR]: CRITICAL: 'Original_Text' column missing in final export list!
2025-04-09 22:38:28 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-09 22:39:53 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-09 22:39:58 [ERROR]: Starting CSV export process
2025-04-09 22:39:58 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-09 22:39:58 [ERROR]: Added missing column: Place_of_Creation
2025-04-09 22:39:58 [ERROR]: Added missing column: Text
2025-04-09 22:39:58 [ERROR]: Using resolved text source column: Original_Text
2025-04-09 22:40:03 [ERROR]: Using metadata headers from preset 'damn it': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-09 22:40:03 [ERROR]: Added essential column: Creation_Place
2025-04-09 22:40:03 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-09 22:40:03 [ERROR]: Copied 14 values for column: Document_Type
2025-04-09 22:40:03 [ERROR]: Copied 14 values for column: Author
2025-04-09 22:40:03 [ERROR]: Copied 14 values for column: Correspondent
2025-04-09 22:40:03 [ERROR]: Copied 14 values for column: Correspondent_Place
2025-04-09 22:40:03 [ERROR]: Copied 14 values for column: Date
2025-04-09 22:40:03 [ERROR]: Copied 14 values for column: Place_of_Creation
2025-04-09 22:40:03 [ERROR]: Copied 14 values for column: People
2025-04-09 22:40:03 [ERROR]: Copied 14 values for column: Places
2025-04-09 22:40:03 [ERROR]: Copied 14 values for column: Summary
2025-04-09 22:40:03 [ERROR]: Copied 14 values for column: Creation_Place
2025-04-09 22:40:04 [ERROR]: Starting date and place analysis sequence using preset: Sequence_Dates
2025-04-09 22:40:04 [ERROR]: Using required headers from sequential preset: ['Date', 'Place']
2025-04-09 22:40:04 [ERROR]: Clearing existing values for fresh date analysis
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 0: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 1: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 2: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 3: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 4: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 5: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 6: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 7: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 8: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 9: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 10: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 11: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 12: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Error getting text for date analysis at idx 13: '_tkinter.tkapp' object has no attribute 'find_right_text'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 914, in _prepare_date_df
    fallback_text = self.app.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'find_right_text'
2025-04-09 22:40:04 [ERROR]: Copied existing Date values from compiled_df to date_df
2025-04-09 22:40:04 [ERROR]: Added legacy Creation_Place column to date_df
2025-04-09 22:40:04 [ERROR]: Created date analysis dataframe with 14 rows and columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-09 22:40:04 [ERROR]: Using specified sequential preset: Sequence_Dates
2025-04-09 22:40:04 [ERROR]: Found required headers in sequence preset: ['Date', 'Place']
2025-04-09 22:40:04 [ERROR]: Setting active sequential preset to: Sequence_Dates
2025-04-09 22:40:04 [ERROR]: Date analysis result dataframe has columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-09 22:40:04 [ERROR]: Date analysis result dataframe has 14 rows
2025-04-09 22:40:04 [ERROR]: Date analysis found 0 dates
2025-04-09 22:40:04 [ERROR]: Date analysis found 0 Date values
2025-04-09 22:40:04 [ERROR]: Date analysis found 0 Place values
2025-04-09 22:40:04 [ERROR]: Sample row 0: {'Page': np.int64(0)}
2025-04-09 22:40:04 [ERROR]: Sample row 1: {'Page': np.int64(1)}
2025-04-09 22:40:04 [ERROR]: Sample row 2: {'Page': np.int64(2)}
2025-04-09 22:40:04 [ERROR]: Date analysis returned dataframe with columns: Page, Text, Date, Place, Creation_Place
2025-04-09 22:40:04 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': '', 'Date': '', 'Place': '', 'Creation_Place': ''}
2025-04-09 22:40:04 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': '', 'Date': '', 'Place': '', 'Creation_Place': ''}
2025-04-09 22:40:04 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '', 'Date': '', 'Place': '', 'Creation_Place': ''}
2025-04-09 22:40:04 [ERROR]: Using specified sequential preset for copying results: Sequence_Dates
2025-04-09 22:40:04 [ERROR]: Copying required headers from sequence preset: ['Date', 'Place']
2025-04-09 22:40:04 [ERROR]: Added missing Place column to compiled_df before copying results
2025-04-09 22:40:04 [ERROR]: No fields were updated in the compiled dataframe
2025-04-09 22:40:04 [ERROR]: Sequential preset headers: ['Date', 'Place']
2025-04-09 22:40:04 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-09 22:40:04 [ERROR]: Using column 'Original_Text' for text
2025-04-09 22:40:04 [ERROR]: Dropped original text source column: Original_Text
2025-04-09 22:40:04 [ERROR]: Metadata headers from preset 'damn it': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-09 22:40:04 [ERROR]: Adding/overwriting with sequential headers: ['Date', 'Place']
2025-04-09 22:40:04 [ERROR]: 'Original_Text' column is missing before final ordering.
2025-04-09 22:40:04 [ERROR]: CRITICAL: 'Original_Text' column missing in final export list!
2025-04-09 22:40:04 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Place']
2025-04-09 22:43:25 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-09 22:43:29 [ERROR]: Starting CSV export process
2025-04-09 22:43:29 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-09 22:43:29 [ERROR]: Added missing column: Text
2025-04-09 22:43:29 [ERROR]: Added missing column: Place_of_Creation
2025-04-09 22:43:29 [ERROR]: Using resolved text source column: Original_Text
2025-04-09 22:43:33 [ERROR]: Using metadata headers from preset 'damn it': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-09 22:43:33 [ERROR]: Added essential column: Creation_Place
2025-04-09 22:43:33 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-09 22:43:33 [ERROR]: Copied 14 values for column: Document_Type
2025-04-09 22:43:33 [ERROR]: Copied 14 values for column: Author
2025-04-09 22:43:33 [ERROR]: Copied 14 values for column: Correspondent
2025-04-09 22:43:33 [ERROR]: Copied 14 values for column: Correspondent_Place
2025-04-09 22:43:33 [ERROR]: Copied 14 values for column: Date
2025-04-09 22:43:33 [ERROR]: Copied 14 values for column: Place_of_Creation
2025-04-09 22:43:33 [ERROR]: Copied 14 values for column: People
2025-04-09 22:43:33 [ERROR]: Copied 14 values for column: Places
2025-04-09 22:43:33 [ERROR]: Copied 14 values for column: Summary
2025-04-09 22:43:33 [ERROR]: Copied 14 values for column: Creation_Place
2025-04-09 22:43:33 [ERROR]: Starting date and place analysis sequence using preset: Sequence_Dates
2025-04-09 22:43:33 [ERROR]: Using required headers from sequential preset: ['Date', 'Place']
2025-04-09 22:43:33 [ERROR]: Clearing existing values for fresh date analysis
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 0: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 1: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 2: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 3: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 4: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 5: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 6: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 7: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 8: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 9: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 10: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 11: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 12: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Error getting text for date analysis at idx 13: '_tkinter.tkapp' object has no attribute 'data_ops'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 915, in _prepare_date_df
    fallback_text = self.app.data_ops.find_right_text(main_idx)
                    ^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'data_ops'
2025-04-09 22:43:33 [ERROR]: Copied existing Date values from compiled_df to date_df
2025-04-09 22:43:33 [ERROR]: Added legacy Creation_Place column to date_df
2025-04-09 22:43:33 [ERROR]: Created date analysis dataframe with 14 rows and columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-09 22:43:34 [ERROR]: Using specified sequential preset: Sequence_Dates
2025-04-09 22:43:34 [ERROR]: Found required headers in sequence preset: ['Date', 'Place']
2025-04-09 22:43:34 [ERROR]: Setting active sequential preset to: Sequence_Dates
2025-04-09 22:43:34 [ERROR]: Date analysis result dataframe has columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-09 22:43:34 [ERROR]: Date analysis result dataframe has 14 rows
2025-04-09 22:43:34 [ERROR]: Date analysis found 0 dates
2025-04-09 22:43:34 [ERROR]: Date analysis found 0 Date values
2025-04-09 22:43:34 [ERROR]: Date analysis found 0 Place values
2025-04-09 22:43:34 [ERROR]: Sample row 0: {'Page': np.int64(0)}
2025-04-09 22:43:34 [ERROR]: Sample row 1: {'Page': np.int64(1)}
2025-04-09 22:43:34 [ERROR]: Sample row 2: {'Page': np.int64(2)}
2025-04-09 22:43:34 [ERROR]: Date analysis returned dataframe with columns: Page, Text, Date, Place, Creation_Place
2025-04-09 22:43:34 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': '', 'Date': '', 'Place': '', 'Creation_Place': ''}
2025-04-09 22:43:34 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': '', 'Date': '', 'Place': '', 'Creation_Place': ''}
2025-04-09 22:43:34 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '', 'Date': '', 'Place': '', 'Creation_Place': ''}
2025-04-09 22:43:34 [ERROR]: Using specified sequential preset for copying results: Sequence_Dates
2025-04-09 22:43:34 [ERROR]: Copying required headers from sequence preset: ['Date', 'Place']
2025-04-09 22:43:34 [ERROR]: Added missing Place column to compiled_df before copying results
2025-04-09 22:43:34 [ERROR]: No fields were updated in the compiled dataframe
2025-04-09 22:43:34 [ERROR]: Sequential preset headers: ['Date', 'Place']
2025-04-09 22:43:34 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-09 22:43:34 [ERROR]: Using column 'Original_Text' for text
2025-04-09 22:43:34 [ERROR]: Dropped original text source column: Original_Text
2025-04-09 22:43:34 [ERROR]: Metadata headers from preset 'damn it': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-09 22:43:34 [ERROR]: Adding/overwriting with sequential headers: ['Date', 'Place']
2025-04-09 22:43:34 [ERROR]: 'Original_Text' column is missing before final ordering.
2025-04-09 22:43:34 [ERROR]: CRITICAL: 'Original_Text' column missing in final export list!
2025-04-09 22:43:34 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Place']
2025-04-09 22:45:40 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-09 22:45:43 [ERROR]: Starting CSV export process
2025-04-09 22:45:43 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-09 22:45:43 [ERROR]: Added missing column: Place_of_Creation
2025-04-09 22:45:43 [ERROR]: Added missing column: Text
2025-04-09 22:45:43 [ERROR]: Using resolved text source column: Original_Text
2025-04-09 22:45:49 [ERROR]: Using metadata headers from preset 'damn it': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-09 22:45:49 [ERROR]: Added essential column: Creation_Place
2025-04-09 22:45:49 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-09 22:45:49 [ERROR]: Copied 14 values for column: Document_Type
2025-04-09 22:45:49 [ERROR]: Copied 14 values for column: Author
2025-04-09 22:45:49 [ERROR]: Copied 14 values for column: Correspondent
2025-04-09 22:45:49 [ERROR]: Copied 14 values for column: Correspondent_Place
2025-04-09 22:45:49 [ERROR]: Copied 14 values for column: Date
2025-04-09 22:45:49 [ERROR]: Copied 14 values for column: Place_of_Creation
2025-04-09 22:45:49 [ERROR]: Copied 14 values for column: People
2025-04-09 22:45:49 [ERROR]: Copied 14 values for column: Places
2025-04-09 22:45:49 [ERROR]: Copied 14 values for column: Summary
2025-04-09 22:45:49 [ERROR]: Copied 14 values for column: Creation_Place
2025-04-09 22:45:49 [ERROR]: Starting date and place analysis sequence using preset: Sequence_Dates
2025-04-09 22:45:49 [ERROR]: Using required headers from sequential preset: ['Date', 'Place']
2025-04-09 22:45:49 [ERROR]: Clearing existing values for fresh date analysis
2025-04-09 22:45:49 [ERROR]: Copied existing Date values from compiled_df to date_df
2025-04-09 22:45:49 [ERROR]: Added legacy Creation_Place column to date_df
2025-04-09 22:45:49 [ERROR]: Created date analysis dataframe with 14 rows and columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-09 22:45:49 [ERROR]: Using specified sequential preset: Sequence_Dates
2025-04-09 22:45:49 [ERROR]: Found required headers in sequence preset: ['Date', 'Place']
2025-04-09 22:45:49 [ERROR]: Setting active sequential preset to: Sequence_Dates
2025-04-09 22:46:06 [ERROR]: Date analysis result dataframe has columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-09 22:46:06 [ERROR]: Date analysis result dataframe has 14 rows
2025-04-09 22:46:06 [ERROR]: Date analysis found 14 dates
2025-04-09 22:46:06 [ERROR]: Date analysis found 14 Date values
2025-04-09 22:46:06 [ERROR]: Date analysis found 14 Place values
2025-04-09 22:46:06 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': 'A Journal of Transactions at 1\nAsh Fall by Mr John Cobb', 'Date': 'Unknown', 'Place': 'Ash Fall', 'Creation_Place': 'Ash Fall'}
2025-04-09 22:46:06 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': '1798.\nAugt 2 Thursday Wind Westerly clear pleasant weather at 2 P. M.\nI set off from Martins Fall with two Boats for Osnaburgh\nHouse and arrived at that place the 19 Inst.', 'Date': '1798/08/02', 'Place': 'Martins Fall', 'Creation_Place': 'Martins Fall'}
2025-04-09 22:46:06 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '20 Monday Wind N Wst with rain all day in the evening\nMr McKay arrived from Martins Fall with 3 Boats', 'Date': '1798/08/20', 'Place': 'Osnaburgh House', 'Creation_Place': 'Osnaburgh House'}
2025-04-09 22:46:06 [ERROR]: Date analysis returned dataframe with columns: Page, Text, Date, Place, Creation_Place
2025-04-09 22:46:06 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': 'A Journal of Transactions at 1\nAsh Fall by Mr John Cobb', 'Date': 'Unknown', 'Place': 'Ash Fall', 'Creation_Place': 'Ash Fall'}
2025-04-09 22:46:06 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': '1798.\nAugt 2 Thursday Wind Westerly clear pleasant weather at 2 P. M.\nI set off from Martins Fall with two Boats for Osnaburgh\nHouse and arrived at that place the 19 Inst.', 'Date': '1798/08/02', 'Place': 'Martins Fall', 'Creation_Place': 'Martins Fall'}
2025-04-09 22:46:06 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '20 Monday Wind N Wst with rain all day in the evening\nMr McKay arrived from Martins Fall with 3 Boats', 'Date': '1798/08/20', 'Place': 'Osnaburgh House', 'Creation_Place': 'Osnaburgh House'}
2025-04-09 22:46:06 [ERROR]: Using specified sequential preset for copying results: Sequence_Dates
2025-04-09 22:46:06 [ERROR]: Copying required headers from sequence preset: ['Date', 'Place']
2025-04-09 22:46:06 [ERROR]: Added missing Place column to compiled_df before copying results
2025-04-09 22:46:06 [ERROR]: Updated fields in the compiled dataframe: 14 Date, 14 Place, 14 Place_of_Creation, 14 Creation_Place
2025-04-09 22:46:06 [ERROR]: Sequential preset headers: ['Date', 'Place']
2025-04-09 22:46:06 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-09 22:46:06 [ERROR]: Using column 'Original_Text' for text
2025-04-09 22:46:06 [ERROR]: Metadata headers from preset 'damn it': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-09 22:46:06 [ERROR]: Adding/overwriting with sequential headers: ['Date', 'Place']
2025-04-09 22:46:06 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Place', 'Original_Text']
2025-04-10 11:15:54 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-10 11:15:59 [ERROR]: Starting CSV export process
2025-04-10 11:15:59 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-10 11:15:59 [ERROR]: Added missing column: Text
2025-04-10 11:15:59 [ERROR]: Added missing column: Place_of_Creation
2025-04-10 11:15:59 [ERROR]: Using resolved text source column: Original_Text
2025-04-10 11:16:03 [ERROR]: Using metadata headers from preset 'Standard Metadata': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-10 11:16:03 [ERROR]: Added essential column: Creation_Place
2025-04-10 11:16:03 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-10 11:16:03 [ERROR]: Copied 20 values for column: Document_Type
2025-04-10 11:16:03 [ERROR]: Copied 20 values for column: Author
2025-04-10 11:16:03 [ERROR]: Copied 20 values for column: Correspondent
2025-04-10 11:16:03 [ERROR]: Copied 20 values for column: Correspondent_Place
2025-04-10 11:16:03 [ERROR]: Copied 20 values for column: Date
2025-04-10 11:16:03 [ERROR]: Copied 20 values for column: Place_of_Creation
2025-04-10 11:16:03 [ERROR]: Copied 20 values for column: People
2025-04-10 11:16:03 [ERROR]: Copied 20 values for column: Places
2025-04-10 11:16:03 [ERROR]: Copied 20 values for column: Summary
2025-04-10 11:16:03 [ERROR]: Copied 20 values for column: Creation_Place
2025-04-10 11:16:03 [ERROR]: Single author specified: test
2025-04-10 11:16:03 [ERROR]: Citation specified: test
2025-04-10 11:16:03 [ERROR]: Starting date and place analysis sequence using preset: Sequence_Dates
2025-04-10 11:16:03 [ERROR]: Using required headers from sequential preset: ['Date', 'Place']
2025-04-10 11:16:03 [ERROR]: Clearing existing values for fresh date analysis
2025-04-10 11:16:03 [ERROR]: Copied existing Date values from compiled_df to date_df
2025-04-10 11:16:03 [ERROR]: Added legacy Creation_Place column to date_df
2025-04-10 11:16:03 [ERROR]: Created date analysis dataframe with 20 rows and columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-10 11:16:03 [ERROR]: Using specified sequential preset: Sequence_Dates
2025-04-10 11:16:03 [ERROR]: Found required headers in sequence preset: ['Date', 'Place']
2025-04-10 11:16:03 [ERROR]: Setting active sequential preset to: Sequence_Dates
2025-04-10 11:16:28 [ERROR]: Date analysis result dataframe has columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-10 11:16:28 [ERROR]: Date analysis result dataframe has 20 rows
2025-04-10 11:16:28 [ERROR]: Date analysis found 20 dates
2025-04-10 11:16:28 [ERROR]: Date analysis found 20 Date values
2025-04-10 11:16:28 [ERROR]: Date analysis found 20 Place values
2025-04-10 11:16:28 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': 'A Journal of Transactions at Ash Fall by Mr John Cobb.', 'Date': 'CHECK', 'Place': 'Ash Fall', 'Creation_Place': 'Ash Fall'}
2025-04-10 11:16:28 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': 'Augt 2 Thursday Wind Westerly clear pleasant weather at 2 P. M. I set off from Martins Fall with two Boats of Osnaburgh House and arrived at that place the 19 Inst.', 'Date': '1800/08/02', 'Place': 'Martins Fall', 'Creation_Place': 'Martins Fall'}
2025-04-10 11:16:28 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '20 Monday Wind N Wst with rain all day in the evening Mr McKay arrived from Martins Fall with 3 Boats', 'Date': '1800/08/20', 'Place': 'Martins Fall', 'Creation_Place': 'Martins Fall'}
2025-04-10 11:16:28 [ERROR]: Date analysis returned dataframe with columns: Page, Text, Date, Place, Creation_Place
2025-04-10 11:16:28 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': 'A Journal of Transactions at Ash Fall by Mr John Cobb.', 'Date': 'CHECK', 'Place': 'Ash Fall', 'Creation_Place': 'Ash Fall'}
2025-04-10 11:16:28 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': 'Augt 2 Thursday Wind Westerly clear pleasant weather at 2 P. M. I set off from Martins Fall with two Boats of Osnaburgh House and arrived at that place the 19 Inst.', 'Date': '1800/08/02', 'Place': 'Martins Fall', 'Creation_Place': 'Martins Fall'}
2025-04-10 11:16:28 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '20 Monday Wind N Wst with rain all day in the evening Mr McKay arrived from Martins Fall with 3 Boats', 'Date': '1800/08/20', 'Place': 'Martins Fall', 'Creation_Place': 'Martins Fall'}
2025-04-10 11:16:28 [ERROR]: Using specified sequential preset for copying results: Sequence_Dates
2025-04-10 11:16:28 [ERROR]: Copying required headers from sequence preset: ['Date', 'Place']
2025-04-10 11:16:28 [ERROR]: Added missing Place column to compiled_df before copying results
2025-04-10 11:16:28 [ERROR]: Updated fields in the compiled dataframe: 20 Date, 20 Place, 20 Place_of_Creation, 20 Creation_Place
2025-04-10 11:16:28 [ERROR]: Sequential preset headers: ['Date', 'Place']
2025-04-10 11:16:28 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-10 11:16:28 [ERROR]: Using column 'Original_Text' for text
2025-04-10 11:16:28 [ERROR]: Overriding 'Author' column with single author: test
2025-04-10 11:16:28 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-10 11:16:28 [ERROR]: Adding/overwriting with sequential headers: ['Date', 'Place']
2025-04-10 11:16:28 [ERROR]: Adding 'Citation' column.
2025-04-10 11:16:28 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Place', 'Original_Text', 'Citation']
2025-04-10 11:18:36 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-10 11:18:40 [ERROR]: Starting CSV export process
2025-04-10 11:18:40 [ERROR]: Filtered DataFrame to 2 relevant/partially relevant rows.
2025-04-10 11:18:40 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-10 11:18:40 [ERROR]: Added missing column: Text
2025-04-10 11:18:40 [ERROR]: Added missing column: Place_of_Creation
2025-04-10 11:18:40 [ERROR]: Using resolved text source column: Original_Text
2025-04-10 11:18:44 [ERROR]: Refresh display error: Failed to refresh display: 1
Index: 1
Stack trace:
Traceback (most recent call last):
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2606, in pandas._libs.hashtable.Int64HashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2630, in pandas._libs.hashtable.Int64HashTable.get_item
KeyError: 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 2064, in refresh_display
    current_toggle = self.main_df.loc[self.page_counter, 'Text_Toggle']
                     ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\frame.py", line 4221, in _get_value
    row = self.index.get_loc(index)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 1
2025-04-10 11:18:44 [ERROR]: Critical error in metadata generation: 1
Stack trace:
Traceback (most recent call last):
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2606, in pandas._libs.hashtable.Int64HashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2630, in pandas._libs.hashtable.Int64HashTable.get_item
KeyError: 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 2064, in refresh_display
    current_toggle = self.main_df.loc[self.page_counter, 'Text_Toggle']
                     ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\frame.py", line 4221, in _get_value
    row = self.index.get_loc(index)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2606, in pandas._libs.hashtable.Int64HashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2630, in pandas._libs.hashtable.Int64HashTable.get_item
KeyError: 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 623, in _generate_metadata
    self.app.ai_functions_handler.ai_function(
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 502, in ai_function
    self.app.refresh_display() # Use refresh_display for consistency
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 2087, in refresh_display
    self.load_text() # Try loading text anyway
    ^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 1602, in load_text
    row_data = self.main_df.loc[index]
               ~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1431, in _getitem_axis
    return self._get_label(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1381, in _get_label
    return self.obj.xs(label, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\generic.py", line 4301, in xs
    loc = index.get_loc(key)
          ^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 1
2025-04-10 11:18:44 [ERROR]: Traceback: Traceback (most recent call last):
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2606, in pandas._libs.hashtable.Int64HashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2630, in pandas._libs.hashtable.Int64HashTable.get_item
KeyError: 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 2064, in refresh_display
    current_toggle = self.main_df.loc[self.page_counter, 'Text_Toggle']
                     ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\frame.py", line 4221, in _get_value
    row = self.index.get_loc(index)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2606, in pandas._libs.hashtable.Int64HashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2630, in pandas._libs.hashtable.Int64HashTable.get_item
KeyError: 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 623, in _generate_metadata
    self.app.ai_functions_handler.ai_function(
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 502, in ai_function
    self.app.refresh_display() # Use refresh_display for consistency
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 2087, in refresh_display
    self.load_text() # Try loading text anyway
    ^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 1602, in load_text
    row_data = self.main_df.loc[index]
               ~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1431, in _getitem_axis
    return self._get_label(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1381, in _get_label
    return self.obj.xs(label, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\generic.py", line 4301, in xs
    loc = index.get_loc(key)
          ^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 1

Stack trace:
Traceback (most recent call last):
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2606, in pandas._libs.hashtable.Int64HashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2630, in pandas._libs.hashtable.Int64HashTable.get_item
KeyError: 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 2064, in refresh_display
    current_toggle = self.main_df.loc[self.page_counter, 'Text_Toggle']
                     ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\frame.py", line 4221, in _get_value
    row = self.index.get_loc(index)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2606, in pandas._libs.hashtable.Int64HashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2630, in pandas._libs.hashtable.Int64HashTable.get_item
KeyError: 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ExportFunctions.py", line 623, in _generate_metadata
    self.app.ai_functions_handler.ai_function(
  File "d:\TranscriptionPearl\util\AIFunctions.py", line 502, in ai_function
    self.app.refresh_display() # Use refresh_display for consistency
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 2087, in refresh_display
    self.load_text() # Try loading text anyway
    ^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 1602, in load_text
    row_data = self.main_df.loc[index]
               ~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1431, in _getitem_axis
    return self._get_label(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1381, in _get_label
    return self.obj.xs(label, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\generic.py", line 4301, in xs
    loc = index.get_loc(key)
          ^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 1
2025-04-10 11:18:44 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-10 11:18:44 [ERROR]: Using column 'Original_Text' for text
2025-04-10 11:18:44 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-10 11:18:44 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Original_Text']
2025-04-10 11:19:13 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-10 11:28:09 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-10 11:28:12 [ERROR]: Starting CSV export process
2025-04-10 11:28:12 [ERROR]: Filtered DataFrame to 1 relevant/partially relevant rows.
2025-04-10 11:28:12 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-10 11:28:12 [ERROR]: Added missing column: Text
2025-04-10 11:28:12 [ERROR]: Added missing column: Place_of_Creation
2025-04-10 11:28:12 [ERROR]: Using resolved text source column: Original_Text
2025-04-10 11:28:16 [ERROR]: Refresh display error: Failed to refresh display: 0
Index: 0
Stack trace:
Traceback (most recent call last):
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2606, in pandas._libs.hashtable.Int64HashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 2630, in pandas._libs.hashtable.Int64HashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 2061, in refresh_display
    current_toggle = self.main_df.loc[self.page_counter, 'Text_Toggle']
                     ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\frame.py", line 4221, in _get_value
    row = self.index.get_loc(index)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 0
2025-04-10 11:28:17 [ERROR]: Using metadata headers from preset 'Standard Metadata': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-10 11:28:17 [ERROR]: Added essential column: Creation_Place
2025-04-10 11:28:17 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-10 11:28:17 [ERROR]: Copied 1 values for column: Document_Type
2025-04-10 11:28:17 [ERROR]: Copied 1 values for column: Author
2025-04-10 11:28:17 [ERROR]: Copied 1 values for column: Correspondent
2025-04-10 11:28:17 [ERROR]: Copied 1 values for column: Correspondent_Place
2025-04-10 11:28:17 [ERROR]: Copied 1 values for column: Date
2025-04-10 11:28:17 [ERROR]: Copied 1 values for column: Place_of_Creation
2025-04-10 11:28:17 [ERROR]: Copied 1 values for column: People
2025-04-10 11:28:17 [ERROR]: Copied 1 values for column: Places
2025-04-10 11:28:17 [ERROR]: Copied 1 values for column: Summary
2025-04-10 11:28:17 [ERROR]: Copied 1 values for column: Creation_Place
2025-04-10 11:28:17 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-10 11:28:17 [ERROR]: Using column 'Original_Text' for text
2025-04-10 11:28:17 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-10 11:28:17 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Original_Text']
2025-04-10 11:35:41 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-10 11:35:44 [ERROR]: Starting CSV export process
2025-04-10 11:35:44 [ERROR]: Filtered DataFrame to 1 relevant/partially relevant rows.
2025-04-10 11:35:44 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-10 11:35:44 [ERROR]: Added missing column: Text
2025-04-10 11:35:44 [ERROR]: Added missing column: Place_of_Creation
2025-04-10 11:35:44 [ERROR]: Using resolved text source column: Original_Text
2025-04-10 11:35:44 [ERROR]: Reset index for temp_df. New length: 1
2025-04-10 11:35:47 [ERROR]: Restored original index to updated_df for alignment.
2025-04-10 11:35:47 [ERROR]: Using metadata headers from preset 'Standard Metadata': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-10 11:35:47 [ERROR]: Added essential column: Creation_Place
2025-04-10 11:35:47 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-10 11:35:47 [ERROR]: Copied 1 values for column: Document_Type
2025-04-10 11:35:47 [ERROR]: Copied 1 values for column: Author
2025-04-10 11:35:47 [ERROR]: Copied 1 values for column: Correspondent
2025-04-10 11:35:47 [ERROR]: Copied 1 values for column: Correspondent_Place
2025-04-10 11:35:47 [ERROR]: Copied 1 values for column: Date
2025-04-10 11:35:47 [ERROR]: Copied 1 values for column: Place_of_Creation
2025-04-10 11:35:47 [ERROR]: Copied 1 values for column: People
2025-04-10 11:35:47 [ERROR]: Copied 1 values for column: Places
2025-04-10 11:35:47 [ERROR]: Copied 1 values for column: Summary
2025-04-10 11:35:47 [ERROR]: Copied 1 values for column: Creation_Place
2025-04-10 11:35:47 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-10 11:35:47 [ERROR]: Using column 'Original_Text' for text
2025-04-10 11:35:47 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-10 11:35:47 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Original_Text']
2025-04-10 13:01:12 [ERROR]: Could not parse rotation angle from response at index 0: bottom edge
2025-04-10 13:02:12 [ERROR]: Could not parse rotation angle from response at index 1: bottom edge
2025-04-10 13:02:12 [ERROR]: Could not parse rotation angle from response at index 2: top edge
2025-04-10 13:02:12 [ERROR]: Could not parse rotation angle from response at index 0: bottom edge
2025-04-10 13:02:36 [ERROR]: Could not parse rotation angle from response at index 2: top edge
2025-04-10 13:38:04 [ERROR]: Error resizing/saving image from D:/OneDrive/Test/test image.jpg to d:\TranscriptionPearl\util\temp\images\0001_p001.jpg: 'bytes' object has no attribute 'get'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ImageHandler.py", line 107, in resize_image
    print(f"Image rotation: {img.info.get('exif', {}).get(274, 0)}")
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'bytes' object has no attribute 'get'
2025-04-10 13:38:04 [ERROR]: Error processing file D:/OneDrive/Test/test image.jpg - Additional Info: 'bytes' object has no attribute 'get'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ImageHandler.py", line 178, in process_new_images
    self.resize_image(source_path, dest_path)
  File "d:\TranscriptionPearl\util\ImageHandler.py", line 107, in resize_image
    print(f"Image rotation: {img.info.get('exif', {}).get(274, 0)}")
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'bytes' object has no attribute 'get'
2025-04-10 13:38:04 [ERROR]: Error in process_new_images: '_tkinter.tkapp' object has no attribute 'messagebox'
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\ImageHandler.py", line 178, in process_new_images
    self.resize_image(source_path, dest_path)
  File "d:\TranscriptionPearl\util\ImageHandler.py", line 107, in resize_image
    print(f"Image rotation: {img.info.get('exif', {}).get(274, 0)}")
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'bytes' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 1332, in process_new_images
    successful_copies, new_rows_list = self.image_handler.process_new_images(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\TranscriptionPearl\util\ImageHandler.py", line 214, in process_new_images
    self.app.messagebox.showerror("Error", f"Failed to process the image {source_path}:\n{e}")
    ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\tkinter\__init__.py", line 2433, in __getattr__
    return getattr(self.tk, attr)
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: '_tkinter.tkapp' object has no attribute 'messagebox'
2025-04-10 13:40:57 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)

2025-04-10 19:46:10 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)

2025-04-10 19:49:16 [ERROR]: Could not parse rotation angle from response at index 0: Rotated 90 degrees Clockwise
2025-04-10 19:50:20 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)
2025-04-10 19:51:30 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)
2025-04-10 19:51:44 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)
2025-04-10 19:52:15 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)
2025-04-10 19:52:48 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)

2025-04-10 19:52:56 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)

2025-04-10 19:53:59 [ERROR]: Could not parse rotation angle from response at index 0: Rotated 90 degrees Clockwise

2025-04-10 19:54:15 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)

2025-04-11 09:50:06 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)

2025-04-11 09:55:28 [ERROR]: Could not parse rotation angle from response at index 1: Rotated 90 degrees Counter-Clockwise

2025-04-11 09:57:44 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)

2025-04-11 10:03:02 [ERROR]: Could not parse rotation angle from response at index 0: Rotated 90 degrees Clockwise

2025-04-11 10:03:50 [ERROR]: Could not parse rotation angle from response at index 0: Upside-down (180 degrees)

2025-04-11 10:10:42 [ERROR]: Could not parse rotation angle from response at index 0: A Journal of Transactions of Ash Fall by Mr. Ichn Cobb
2025-04-11 10:11:00 [ERROR]: Could not parse rotation angle from response at index 0: A Journal of Transactions at
2025-04-11 10:11:15 [ERROR]: Could not parse rotation angle from response at index 0: A Journal of Transactions at Ash Fall by Mr. John Cobb.
2025-04-11 10:11:31 [ERROR]: Could not parse rotation angle from response at index 0: A Journal of Transactions at Ash Fall by Mr. Schn Cobb.
2025-04-11 10:13:54 [ERROR]: Could not parse rotation angle from response at index 0: The first text that a human reader would read on the page is "A Journal of Transactions at".
The text is closest to the top margin.
2025-04-11 10:15:22 [ERROR]: Could not parse rotation angle from response at index 0: Here's my analysis:

1.  **First Text:** The first text a human reader would likely read is "A Journal of Transactions at".
2.  **Margin Alignment:** This text is closest to and aligned with the **top** margin.

Therefore, the image orientation is top.

2025-04-11 10:16:32 [ERROR]: Could not parse rotation angle from response at index 0: Here's my analysis:

1.  **First Text:** "A Journal of Transactions at"
2.  **Alignment:** Top

2025-04-11 10:17:43 [ERROR]: Could not parse rotation angle from response at index 0: Here's the breakdown:

1.  **First Text:** "A Journal of Transactions at"
2.  **Bounding Box Coordinates:** (68, 68, 400, 130)
3.  **Alignment:** Top

2025-04-11 10:41:33 [ERROR]: Could not parse rotation angle from response at index 1: 90 degrees counter-clockwise
2025-04-11 10:42:20 [ERROR]: Could not parse rotation angle from response at index 0: 90 degrees clockwise
2025-04-11 10:42:48 [ERROR]: Could not parse rotation angle from response at index 0: 90 degrees counter-clockwise
2025-04-11 10:43:55 [ERROR]: Could not parse rotation angle from response at index 0: 90 degrees counter-clockwise
2025-04-11 10:44:31 [ERROR]: Could not parse rotation angle from response at index 1: 90 degrees counter-clockwise
2025-04-11 16:40:07 [ERROR]: Could not parse rotation angle from response at index 2: 90 degrees counter-clockwise
2025-04-11 21:38:44 [ERROR]: Could not find 'Orientation:' marker in response at index 1: standard
2025-04-11 21:38:44 [ERROR]: Could not determine valid rotation angle from response at index 1: standard
2025-04-11 21:39:09 [ERROR]: Could not find 'Orientation:' marker in response at index 1: standard
2025-04-11 21:39:09 [ERROR]: Could not determine valid rotation angle from response at index 1: standard
2025-04-11 21:39:32 [ERROR]: Could not find 'Orientation:' marker in response at index 0: standard
2025-04-11 21:39:32 [ERROR]: Could not determine valid rotation angle from response at index 0: standard
2025-04-11 21:40:10 [ERROR]: Could not find 'Orientation:' marker in response at index 1: standard
2025-04-11 21:40:10 [ERROR]: Could not determine valid rotation angle from response at index 1: standard
2025-04-11 21:40:48 [ERROR]: Could not find 'Orientation:' marker in response at index 1: standard
2025-04-11 21:40:48 [ERROR]: Could not determine valid rotation angle from response at index 1: standard
2025-04-11 21:42:11 [ERROR]: Could not parse rotation angle from response at index 1: 90 degrees counter-clockwise
2025-04-11 21:43:58 [ERROR]: Could not parse rotation angle from response at index 0: 90 degrees counter-clockwise
2025-04-11 21:55:26 [ERROR]: Could not find 'Orientation:' marker in response at index 0: 90 degrees counter-clockwise
2025-04-11 21:55:26 [ERROR]: Could not determine valid rotation angle from response at index 0: 90 degrees counter-clockwise
2025-04-11 21:56:07 [ERROR]: Could not find 'Orientation:' marker in response at index 0: right
2025-04-11 21:56:07 [ERROR]: Could not determine valid rotation angle from response at index 0: right
2025-04-11 21:59:05 [ERROR]: Could not find 'Orientation:' marker in response at index 0: right
2025-04-11 21:59:05 [ERROR]: Could not determine valid rotation angle from response at index 0: right
2025-04-11 21:59:46 [ERROR]: Could not find 'Orientation:' marker in response at index 2: top
2025-04-11 21:59:46 [ERROR]: Could not determine valid rotation angle from response at index 2: top
2025-04-11 22:00:16 [ERROR]: Could not find 'Orientation:' marker in response at index 3: top
2025-04-11 22:00:16 [ERROR]: Could not determine valid rotation angle from response at index 3: top
2025-04-11 22:16:46 [ERROR]: Could not find 'Orientation:' marker in response at index 0: Here are the bounding box detections:
```json
[
  {"box_2d": [40, 235, 142, 935], "label": "title"}
]
```
2025-04-11 22:16:46 [ERROR]: Could not determine valid rotation angle from response at index 0: Here are the bounding box detections:
```json
[
  {"box_2d": [40, 235, 142, 935], "label": "title"}
]
```
2025-04-11 22:17:31 [ERROR]: Could not find 'Orientation:' marker in response at index 0: Here are the bounding box detections:
```json
[
  {"box_2d": [837, 112, 935, 834], "label": "A Journal of transactions at"},
  {"box_2d": [878, 495, 935, 706], "label": "Ichn Cobb"},
]
```
2025-04-11 22:17:31 [ERROR]: Could not determine valid rotation angle from response at index 0: Here are the bounding box detections:
```json
[
  {"box_2d": [837, 112, 935, 834], "label": "A Journal of transactions at"},
  {"box_2d": [878, 495, 935, 706], "label": "Ichn Cobb"},
]
```
2025-04-11 22:18:58 [ERROR]: Could not find 'Orientation:' marker in response at index 0: Here are the bounding box detections:
```json
[
  {"box_2d": [44, 243, 135, 896], "label": "title"}
]
```
2025-04-11 22:18:58 [ERROR]: Could not determine valid rotation angle from response at index 0: Here are the bounding box detections:
```json
[
  {"box_2d": [44, 243, 135, 896], "label": "title"}
]
```
2025-04-11 22:23:46 [ERROR]: Could not find 'Orientation:' marker in response at index 0: Here are the bounding box detections:
```json
[
  {"box_2d": [839, 112, 935, 829], "label": "text"}
]
```
2025-04-11 22:23:46 [ERROR]: Could not determine valid rotation angle from response at index 0: Here are the bounding box detections:
```json
[
  {"box_2d": [839, 112, 935, 829], "label": "text"}
]
```
2025-04-11 22:34:57 [ERROR]: Could not find 'Orientation:' marker in response at index 0: Here are the bounding box detections:
```json
[
  {"box_2d": [51, 237, 140, 929], "label": "title"}
]
```
2025-04-11 22:34:57 [ERROR]: Could not determine valid rotation angle from response at index 0: Here are the bounding box detections:
```json
[
  {"box_2d": [51, 237, 140, 929], "label": "title"}
]
```
2025-04-11 22:47:16 [ERROR]: Failed to parse JSON or extract box_2d for index 0: Expecting value: line 1 column 1 (char 0)
Response: Here are the bounding box detections:
```json
[
  {"box_2d": [143, 763, 740, 956], "label": "title"}
]
```
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\DataOperations.py", line 475, in determine_rotation_from_box
    boxes_data = json.loads(json_response_str)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-04-11 22:50:47 [ERROR]: Failed to parse JSON or extract box_2d for index 0: Expecting value: line 1 column 1 (char 0)
Response: Here are the bounding box detections:
```json
[
  {"box_2d": [839, 112, 935, 829], "label": "text"}
]
```
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\DataOperations.py", line 475, in determine_rotation_from_box
    boxes_data = json.loads(json_response_str)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-04-11 22:51:55 [ERROR]: Failed to parse JSON or extract box_2d for index 0: Expecting value: line 1 column 1 (char 0)
Response: Here are the bounding box detections:
```json
[
  {"box_2d": [839, 112, 935, 829], "label": "text"}
]
```
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\DataOperations.py", line 475, in determine_rotation_from_box
    boxes_data = json.loads(json_response_str)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-04-11 22:53:22 [ERROR]: Failed to parse JSON or extract box_2d for index 0: Expecting value: line 1 column 1 (char 0)
Response: Here are the bounding box detections:
```json
[
  {"box_2d": [839, 112, 935, 829], "label": "text"}
]
```
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\DataOperations.py", line 476, in determine_rotation_from_box
    boxes_data = json.loads(json_response_str)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-04-11 22:59:22 [ERROR]: Failed to parse JSON or extract box_2d for index 0: Expecting value: line 3 column 1 (char 79)
Response: Here are the bounding box detections:
```json
[
  {"box_2d": [839, 116, 935, 829], "label": "A Journal of transactions at"},
]
```
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\DataOperations.py", line 499, in determine_rotation_from_box
    boxes_data = json.loads(potential_json)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 3 column 1 (char 79)
2025-04-11 23:02:30 [ERROR]: Failed to parse JSON or extract box_2d for index 2: Expecting value: line 3 column 1 (char 116)
Response: Here are the bounding box detections:
```json
[
  {"box_2d": [913, 41, 953, 958], "label": "beyond the Term of it; Your being alone, will render it impossible"},
]
```
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\DataOperations.py", line 499, in determine_rotation_from_box
    boxes_data = json.loads(potential_json)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 3 column 1 (char 116)
2025-04-11 23:02:31 [ERROR]: Failed to parse JSON or extract box_2d for index 1: Expecting value: line 5 column 1 (char 244)
Response: Here are the bounding box detections:
```json
[
  {"box_2d": [915, 625, 945, 933], "label": "I will be more communicatives, in the mean time I remain."},
  {"box_2d": [835, 625, 864, 750], "label": "Gentlemen"},
  {"box_2d": [773, 625, 814, 933], "label": "B. The Firm of the House will"},
]
```
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\DataOperations.py", line 499, in determine_rotation_from_box
    boxes_data = json.loads(potential_json)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 5 column 1 (char 244)
2025-04-11 23:03:34 [ERROR]: Failed to parse JSON or extract box_2d for index 2: Expecting value: line 3 column 1 (char 116)
Response: Here are the bounding box detections:
```json
[
  {"box_2d": [913, 41, 953, 958], "label": "beyond the Term of it; Your being alone, will render it impossible"},
]
```
Stack trace:
Traceback (most recent call last):
  File "d:\TranscriptionPearl\util\DataOperations.py", line 499, in determine_rotation_from_box
    boxes_data = json.loads(potential_json)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\anaconda3\envs\TranscriptionPearl\Lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 3 column 1 (char 116)
2025-04-13 08:44:35 [ERROR]: Error processing PDF file C:/Users/mark_/OneDrive/Fur Trade Project/Collaborations/LaCloche/Sault Ste-Marie/Post Journals/B194-A-1.pdf - Additional Info: '_tkinter.tkapp' object has no attribute 'open_pdf'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 1778, in drop
    self.open_pdf(pdf_file)
    ^^^^^^^^^^^^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\tkinter\__init__.py", line 2546, in __getattr__
    return getattr(self.tk, attr)
AttributeError: '_tkinter.tkapp' object has no attribute 'open_pdf'
2025-04-13 08:46:22 [ERROR]: Error in open_pdf: 'ProgressBar' object has no attribute 'set_total_steps'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\ProjectIO.py", line 382, in open_pdf
    self.app.progress_bar.set_total_steps(total_pages) # Use set_total_steps
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ProgressBar' object has no attribute 'set_total_steps'
2025-04-13 08:46:22 [ERROR]: Error processing PDF file C:/Users/mark_/OneDrive/Fur Trade Project/Collaborations/LaCloche/Sault Ste-Marie/Post Journals/B194-A-1.pdf - Additional Info: name 'traceback' is not defined
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\ProjectIO.py", line 382, in open_pdf
    self.app.progress_bar.set_total_steps(total_pages) # Use set_total_steps
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ProgressBar' object has no attribute 'set_total_steps'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\TranscriptionPearl_beta-dev.py", line 1778, in drop
    self.project_io.open_pdf(pdf_file) # <--- Corrected call
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\ProjectIO.py", line 475, in open_pdf
    traceback.print_exc() # Print detailed traceback for debugging
    ^^^^^^^^^
NameError: name 'traceback' is not defined. Did you forget to import 'traceback'?
2025-04-13 08:47:48 [ERROR]: Error in open_pdf: ProgressBar.update_progress() missing 1 required positional argument: 'total_rows'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\ProjectIO.py", line 384, in open_pdf
    self.app.progress_bar.update_progress(0) # Update progress to 0
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TypeError: ProgressBar.update_progress() missing 1 required positional argument: 'total_rows'
2025-04-13 08:48:31 [ERROR]: Error in open_pdf: ProgressBar.update_progress() missing 1 required positional argument: 'total_rows'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\ProjectIO.py", line 389, in open_pdf
    self.app.progress_bar.update_progress(page_num + 1)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: ProgressBar.update_progress() missing 1 required positional argument: 'total_rows'
2025-04-13 08:54:54 [ERROR]: API returned error for index 29, job HTR
2025-04-13 08:54:54 [ERROR]: API returned error for index 41, job HTR
2025-04-13 08:54:54 [ERROR]: API returned error for index 6, job HTR
2025-04-13 08:54:54 [ERROR]: API returned error for index 35, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 37, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 22, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 9, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 15, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 1, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 30, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 38, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 31, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 21, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 40, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 19, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 23, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 4, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 20, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 8, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 25, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 36, job HTR
2025-04-13 08:54:55 [ERROR]: API returned error for index 5, job HTR
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 0, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 1, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 2, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 3, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 4, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 5, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 6, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 7, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 8, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 9, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 10, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 11, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 12, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 13, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 14, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 15, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 16, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 17, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 18, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API Error during processing for index 19, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:28:30 [ERROR]: API returned error for index 3, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 5, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 10, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 4, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 13, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 12, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 2, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 11, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 6, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 8, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 15, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 0, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 18, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 1, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 14, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 9, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 16, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 7, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 17, job HTR
2025-04-15 10:28:30 [ERROR]: API returned error for index 19, job HTR
2025-04-15 10:29:40 [ERROR]: API Error during processing for index 0, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:29:40 [ERROR]: API returned error for index 0, job HTR
2025-04-15 10:31:17 [ERROR]: API Error during processing for index 0, job HTR - Additional Info: Client.__init__() got an unexpected keyword argument 'proxies'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 40, in process_api_request
    return await self.app.api_handler.route_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 65, in route_api_call
    return await self.handle_gpt_call(system_prompt, user_prompt, temp,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
                                   api_timeout, job_type, required_headers)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\APIHandler.py", line 136, in handle_gpt_call
    client = OpenAI(api_key=self.openai_api_key, timeout=api_timeout)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_client.py", line 123, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        version=__version__,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        _strict_response_validation=_strict_response_validation,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 857, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
                                  ~~~~~~~~~~~~~~~~~~~~~~^
        base_url=base_url,
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        follow_redirects=True,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\openai\_base_client.py", line 755, in __init__
    super().__init__(**kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: Client.__init__() got an unexpected keyword argument 'proxies'
2025-04-15 10:31:17 [ERROR]: API returned error for index 0, job HTR
2025-04-15 11:04:09 [ERROR]: Error in ai_function orchestration for job Chunk_Text: '_tkinter.tkapp' object has no attribute 'find_chunk_text'
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 138, in ai_function
    batch_df = self.app.main_df[self.app.main_df.apply(page_has_chunkable_text, axis=1)]
                                ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
           ~~~~~~~~^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
                 ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 135, in page_has_chunkable_text
    fallback_text, _ = self.app.find_chunk_text(row.name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\tkinter\__init__.py", line 2546, in __getattr__
    return getattr(self.tk, attr)
AttributeError: '_tkinter.tkapp' object has no attribute 'find_chunk_text'
2025-04-15 11:13:31 [ERROR]: Enabled Errors highlighting due to existing Errors data
2025-04-15 11:17:30 [ERROR]: Enabled Errors highlighting due to existing Errors data
2025-04-15 11:19:31 [ERROR]: Enabled Names highlighting due to existing People data
2025-04-15 12:07:08 [ERROR]: Resolved 'Current Display' to actual column: Separated_Text
2025-04-15 12:07:16 [ERROR]: Starting CSV export process
2025-04-15 12:07:16 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-15 12:07:16 [ERROR]: Added missing column: Text
2025-04-15 12:07:16 [ERROR]: Added missing column: Place_of_Creation
2025-04-15 12:07:16 [ERROR]: Using resolved text source column: Separated_Text
2025-04-15 12:07:16 [ERROR]: Reset index for temp_df. New length: 45
2025-04-15 12:07:55 [ERROR]: Restored original index to updated_df for alignment.
2025-04-15 12:07:55 [ERROR]: Using metadata headers from preset 'Standard Metadata': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-15 12:07:55 [ERROR]: Added essential column: Creation_Place
2025-04-15 12:07:55 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-15 12:07:55 [ERROR]: Copied 45 values for column: Document_Type
2025-04-15 12:07:55 [ERROR]: Copied 45 values for column: Author
2025-04-15 12:07:55 [ERROR]: Copied 45 values for column: Correspondent
2025-04-15 12:07:55 [ERROR]: Copied 45 values for column: Correspondent_Place
2025-04-15 12:07:55 [ERROR]: Copied 45 values for column: Date
2025-04-15 12:07:55 [ERROR]: Copied 45 values for column: Place_of_Creation
2025-04-15 12:07:55 [ERROR]: Copied 45 values for column: People
2025-04-15 12:07:55 [ERROR]: Copied 45 values for column: Places
2025-04-15 12:07:55 [ERROR]: Copied 45 values for column: Summary
2025-04-15 12:07:55 [ERROR]: Copied 45 values for column: Creation_Place
2025-04-15 12:07:55 [ERROR]: Single author specified: Angus Bethune
2025-04-15 12:07:55 [ERROR]: Citation specified: HBCA, B194-A-1
2025-04-15 12:07:55 [ERROR]: Starting date and place analysis sequence using preset: Sequence_Dates
2025-04-15 12:07:55 [ERROR]: Using required headers from sequential preset: ['Date', 'Place']
2025-04-15 12:07:55 [ERROR]: Clearing existing values for fresh date analysis
2025-04-15 12:07:55 [ERROR]: Copied existing Date values from compiled_df to date_df
2025-04-15 12:07:55 [ERROR]: Added legacy Creation_Place column to date_df
2025-04-15 12:07:55 [ERROR]: Created date analysis dataframe with 45 rows and columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-15 12:07:55 [ERROR]: Using specified sequential preset: Sequence_Dates
2025-04-15 12:07:55 [ERROR]: Found required headers in sequence preset: ['Date', 'Place']
2025-04-15 12:07:55 [ERROR]: Setting active sequential preset to: Sequence_Dates
2025-04-15 12:08:16 [ERROR]: Date analysis result dataframe has columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-15 12:08:16 [ERROR]: Date analysis result dataframe has 45 rows
2025-04-15 12:08:16 [ERROR]: Date analysis found 0 dates
2025-04-15 12:08:16 [ERROR]: Date analysis found 0 Date values
2025-04-15 12:08:16 [ERROR]: Date analysis found 0 Place values
2025-04-15 12:08:16 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': "*****\n1824/09/01 Wednesday: Sultry weather a little rain in the forenoon. Recd the charge of the Post from Mr McBean. The engaged men of the Post are Amable Bienvenue, Philibert Siccard, Charles De Lorme and Antoine Bougran. The porkeaters are Vital Mandeville, Francois Obichon, Jean Bte Bon Enfant, Joseph Pichette, Joseph De Sourrell, Michel Chatillon Pierre Gaudet & Antoine La Pertie. The discharged servants of the Post are Joseph Couture, and Martin Boulez; those from Lake Superior District are Louis St Jean Xavier Millionie Amable Dupras and old Clarke Uofr. Mr John Mc Intosh, John Taylor and Mr Geo. Innis are here on business from Michipiccoton. The gentlemen belonging to Lake Huron Department are John Mc Bean Esqr Messrs McKay, Cowie, Varren & Bourassa's. There is an old man Joseph De Verdure a freeman who is in the habit of jobbing about the Fort for his living There is no regular work for the men as yet being employed for the present in various jobs about the Fort. -\n\n*****\n1824/09/02 Thursday: Fine Weather. Amable Bienvenue at Smiths work. Charles De Lorme was making up cordwood which had been cut last Winter, it amounts to 44 Cords. The old man De Verdure went to shew it to him. Siccard's duty is to attend to the Live Stock and the dairy. Antoine Bougran employed as Cook and Domestic. Mr McBean was packing up his Goods with a batteau load of which the Messrs Bourassa's took their departure in the afternoon The porkeaters remain unemployed at the Fort -\n\n*****\n1824/09/03 Friday: Cloudy Weather at times, some rain last night and in forenoon The Blacksmith unwell today. The other men employed as yesterday day Doctor Foote of the American Garrison was over in the forenoon on a visit Mr Chat. McKingie and family arrived in the forenoon from Montreal in a North Canoe manned by four Iroquois and a Canadian Mr Mc Bean & his people were preparing for Lake Huron. Entered into engagements with two freemen for a month to square wood their names are Francois Sopier and Jean Bte Perrault. -"}
2025-04-15 12:08:16 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': '*****\nYYYY/09/04 Saturday: Wet weather at intervals The men of the Fort employed as they were these few days past. Messrs Varin and Mc Kay took their departure for La Cloche in the Afternoon. Mr Ermatinger was here in the evening.\n\n*****\nYYYY/09/05 Sunday: A Wet afternoon There were some freemen who came here today applying for labour, no arrangement could be made with them on account of the extravagance of their demands. Messrs Mc Bean McKenzie and Cowie took their departure in the Afternoon for Lake Huron Louis St Jean and Xavier Mellonnie discharged servants from Fort William embarked in Mr McKenzies Canoe to go to Montreal.\n\n*****\nYYYY/09/06 Monday: A strong N.erly breeze throughout. Amable Benomme at some smiths and Carpenters work. Phillibert Sicard attending the cattle an Antoine Bourgeau employed as Cook &c he also cleaned out the new house into which I removed this Afternoon. In the forenoon sent off Chas de Lorime Francois Lopeur, Joseph Couture, Martin Boulay & Xavier Perrault under the direction of J Bte Perrault to the Pointe aux Pins, to fell, square and collect Logs for building a store this winter. They are provided with the necessary tools & carry on the work, horses to haul out the Logs and are served out with rations for a fortnight, There have been some more freemen applying for labour and one of those that were here yesterday sent word that he would come and work today, but I prefer having nothing to do with them. Unfortunately there are some of these people who have acquired bad habits, and besides are but indifferent workmen. Mr Mc Intosh has been down in the suburbs today to learn what Mr Sayer intends to do this winter, he reports that Sayer intends going to the same place at which he wintered last Year.\n\n*****\nYYYY/09/07 Tuesday: A little frost last night A strong breeze a North throughout Phillibert Sicard after going through the necessary duties of the dairy commenced reaping Gourlay Amable Benomme asked permission to go to the suburbs last night, he returned this morning and in such a state as to be unfit for duty, I gave him a severe reprimand which I think will prevent him from doing the like again Got the stores arranged by two of the freighters Bourgeau employed as usual and washing some rooms.'}
2025-04-15 12:08:16 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '*****\nYYYY/09/08 Wednesday: A smart frost last night, blowing fresh at North. There was a report last night of which I did not hear until this morning that a Boat and Canoe were going in to trade along Lake Superior under the command of one Cadotte. The Michif puscotton men went off early in the morning to ascertain who they were and when they were going; they returned in the Afternoon with an account that they were Indians who were seen rowing in a Canoe which gave rise to the story about the Bout &c. A Bienvenu sawing plank for Doors and Sashes for the new Buildings. Secard was employed as yesterday until the cattle began to break through the fence, he was then obliged to leave off to attend them whilst finding in the aftern The Barley was reaped by the Porkeaters. Messrs Ferguson and Whistler of the Boundary line Commission have arrived at the American Garrison. -\n\n*****\nYYYY/09/09 Thursday: Fine Weather. Amable Bienvenu employed as yesterday. Phillibut Secard is bringing the Cows to an increase of Milk and begins to make Butter. The porkeaters were doing some work about the house Viz. cleaning out the Currican, making up some hay and a sty in which to put the Pigs for the Winter. In the Afternoon Messrs Griswold and Ferguson came over on a visit, the latter gentleman took away a Case containing a chain from Mr Thompsons Store, which he said belonged to the U. S. boundary line commission. -\n\n*****\nYYYY/09/10 Friday: Wind at South, fine Weather. Amable Bienvenu finished Sawing the Boards for Sashes &c. and was afterwards with the assistance of Vital Mandeville laying out boards to be prepared for Weatherboards for a Store. Phillibut Secard at the usual employment. - -\n\n*****\nYYYY/09/11 Saturday: Wind and Weather as yesterday. The porkeaters have engaged to work by the Week until the arrival of the Canoes from the North at the rate of a Buffalo Robe and 4 livres 10 Sols p Week there were three of them with Amable Bienvenu attending the Saw mill sawing the boards laid out for Weatherboards yesterday, they would have done at noon, had there been more water but owing to the S Wind there was not enough to Keep the Mill going half the'}
2025-04-15 12:08:16 [ERROR]: Date analysis returned dataframe with columns: Page, Text, Date, Place, Creation_Place
2025-04-15 12:08:16 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': "*****\n1824/09/01 Wednesday: Sultry weather a little rain in the forenoon. Recd the charge of the Post from Mr McBean. The engaged men of the Post are Amable Bienvenue, Philibert Siccard, Charles De Lorme and Antoine Bougran. The porkeaters are Vital Mandeville, Francois Obichon, Jean Bte Bon Enfant, Joseph Pichette, Joseph De Sourrell, Michel Chatillon Pierre Gaudet & Antoine La Pertie. The discharged servants of the Post are Joseph Couture, and Martin Boulez; those from Lake Superior District are Louis St Jean Xavier Millionie Amable Dupras and old Clarke Uofr. Mr John Mc Intosh, John Taylor and Mr Geo. Innis are here on business from Michipiccoton. The gentlemen belonging to Lake Huron Department are John Mc Bean Esqr Messrs McKay, Cowie, Varren & Bourassa's. There is an old man Joseph De Verdure a freeman who is in the habit of jobbing about the Fort for his living There is no regular work for the men as yet being employed for the present in various jobs about the Fort. -\n\n*****\n1824/09/02 Thursday: Fine Weather. Amable Bienvenue at Smiths work. Charles De Lorme was making up cordwood which had been cut last Winter, it amounts to 44 Cords. The old man De Verdure went to shew it to him. Siccard's duty is to attend to the Live Stock and the dairy. Antoine Bougran employed as Cook and Domestic. Mr McBean was packing up his Goods with a batteau load of which the Messrs Bourassa's took their departure in the afternoon The porkeaters remain unemployed at the Fort -\n\n*****\n1824/09/03 Friday: Cloudy Weather at times, some rain last night and in forenoon The Blacksmith unwell today. The other men employed as yesterday day Doctor Foote of the American Garrison was over in the forenoon on a visit Mr Chat. McKingie and family arrived in the forenoon from Montreal in a North Canoe manned by four Iroquois and a Canadian Mr Mc Bean & his people were preparing for Lake Huron. Entered into engagements with two freemen for a month to square wood their names are Francois Sopier and Jean Bte Perrault. -", 'Date': '', 'Place': '', 'Creation_Place': ''}
2025-04-15 12:08:16 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': '*****\nYYYY/09/04 Saturday: Wet weather at intervals The men of the Fort employed as they were these few days past. Messrs Varin and Mc Kay took their departure for La Cloche in the Afternoon. Mr Ermatinger was here in the evening.\n\n*****\nYYYY/09/05 Sunday: A Wet afternoon There were some freemen who came here today applying for labour, no arrangement could be made with them on account of the extravagance of their demands. Messrs Mc Bean McKenzie and Cowie took their departure in the Afternoon for Lake Huron Louis St Jean and Xavier Mellonnie discharged servants from Fort William embarked in Mr McKenzies Canoe to go to Montreal.\n\n*****\nYYYY/09/06 Monday: A strong N.erly breeze throughout. Amable Benomme at some smiths and Carpenters work. Phillibert Sicard attending the cattle an Antoine Bourgeau employed as Cook &c he also cleaned out the new house into which I removed this Afternoon. In the forenoon sent off Chas de Lorime Francois Lopeur, Joseph Couture, Martin Boulay & Xavier Perrault under the direction of J Bte Perrault to the Pointe aux Pins, to fell, square and collect Logs for building a store this winter. They are provided with the necessary tools & carry on the work, horses to haul out the Logs and are served out with rations for a fortnight, There have been some more freemen applying for labour and one of those that were here yesterday sent word that he would come and work today, but I prefer having nothing to do with them. Unfortunately there are some of these people who have acquired bad habits, and besides are but indifferent workmen. Mr Mc Intosh has been down in the suburbs today to learn what Mr Sayer intends to do this winter, he reports that Sayer intends going to the same place at which he wintered last Year.\n\n*****\nYYYY/09/07 Tuesday: A little frost last night A strong breeze a North throughout Phillibert Sicard after going through the necessary duties of the dairy commenced reaping Gourlay Amable Benomme asked permission to go to the suburbs last night, he returned this morning and in such a state as to be unfit for duty, I gave him a severe reprimand which I think will prevent him from doing the like again Got the stores arranged by two of the freighters Bourgeau employed as usual and washing some rooms.', 'Date': '', 'Place': '', 'Creation_Place': ''}
2025-04-15 12:08:16 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '*****\nYYYY/09/08 Wednesday: A smart frost last night, blowing fresh at North. There was a report last night of which I did not hear until this morning that a Boat and Canoe were going in to trade along Lake Superior under the command of one Cadotte. The Michif puscotton men went off early in the morning to ascertain who they were and when they were going; they returned in the Afternoon with an account that they were Indians who were seen rowing in a Canoe which gave rise to the story about the Bout &c. A Bienvenu sawing plank for Doors and Sashes for the new Buildings. Secard was employed as yesterday until the cattle began to break through the fence, he was then obliged to leave off to attend them whilst finding in the aftern The Barley was reaped by the Porkeaters. Messrs Ferguson and Whistler of the Boundary line Commission have arrived at the American Garrison. -\n\n*****\nYYYY/09/09 Thursday: Fine Weather. Amable Bienvenu employed as yesterday. Phillibut Secard is bringing the Cows to an increase of Milk and begins to make Butter. The porkeaters were doing some work about the house Viz. cleaning out the Currican, making up some hay and a sty in which to put the Pigs for the Winter. In the Afternoon Messrs Griswold and Ferguson came over on a visit, the latter gentleman took away a Case containing a chain from Mr Thompsons Store, which he said belonged to the U. S. boundary line commission. -\n\n*****\nYYYY/09/10 Friday: Wind at South, fine Weather. Amable Bienvenu finished Sawing the Boards for Sashes &c. and was afterwards with the assistance of Vital Mandeville laying out boards to be prepared for Weatherboards for a Store. Phillibut Secard at the usual employment. - -\n\n*****\nYYYY/09/11 Saturday: Wind and Weather as yesterday. The porkeaters have engaged to work by the Week until the arrival of the Canoes from the North at the rate of a Buffalo Robe and 4 livres 10 Sols p Week there were three of them with Amable Bienvenu attending the Saw mill sawing the boards laid out for Weatherboards yesterday, they would have done at noon, had there been more water but owing to the S Wind there was not enough to Keep the Mill going half the', 'Date': '', 'Place': '', 'Creation_Place': ''}
2025-04-15 12:08:16 [ERROR]: Date and place analysis failed: invalid command name ".!toplevel10.!label"
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\ExportFunctions.py", line 846, in _analyze_dates_sequentially
    progress_label.config(text="Finalizing date and place analysis...")
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\tkinter\__init__.py", line 1822, in configure
    return self._configure('configure', cnf, kw)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\tkinter\__init__.py", line 1812, in _configure
    self.tk.call(_flatten((self._w, cmd)) + self._options(cnf))
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_tkinter.TclError: invalid command name ".!toplevel10.!label"
2025-04-15 12:08:18 [ERROR]: Sequential preset headers: ['Date', 'Place']
2025-04-15 12:08:18 [ERROR]: Preparing export dataframe. Text source: Separated_Text
2025-04-15 12:08:18 [ERROR]: Using column 'Separated_Text' for text
2025-04-15 12:08:18 [ERROR]: Dropped original text source column: Separated_Text
2025-04-15 12:08:18 [ERROR]: Overriding 'Author' column with single author: Angus Bethune
2025-04-15 12:08:18 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-15 12:08:18 [ERROR]: Adding/overwriting with sequential headers: ['Date', 'Place']
2025-04-15 12:08:18 [ERROR]: Sequential header 'Place' not found in compiled data.
2025-04-15 12:08:18 [ERROR]: Adding 'Citation' column.
2025-04-15 12:08:18 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Original_Text', 'Citation']
2025-04-15 12:17:30 [ERROR]: Resolved 'Current Display' to actual column: Original_Text
2025-04-15 12:17:57 [ERROR]: Starting CSV export process
2025-04-15 12:17:57 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-15 12:17:57 [ERROR]: Added missing column: Text
2025-04-15 12:17:57 [ERROR]: Added missing column: Place_of_Creation
2025-04-15 12:17:57 [ERROR]: Using resolved text source column: Original_Text
2025-04-15 12:17:57 [ERROR]: Reset index for temp_df. New length: 257
2025-04-15 12:19:05 [ERROR]: Restored original index to updated_df for alignment.
2025-04-15 12:19:05 [ERROR]: Using metadata headers from preset 'Standard Metadata': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-15 12:19:05 [ERROR]: Added essential column: Creation_Place
2025-04-15 12:19:05 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-15 12:19:05 [ERROR]: Copied 257 values for column: Document_Type
2025-04-15 12:19:05 [ERROR]: Copied 257 values for column: Author
2025-04-15 12:19:05 [ERROR]: Copied 257 values for column: Correspondent
2025-04-15 12:19:05 [ERROR]: Copied 257 values for column: Correspondent_Place
2025-04-15 12:19:05 [ERROR]: Copied 257 values for column: Date
2025-04-15 12:19:05 [ERROR]: Copied 257 values for column: Place_of_Creation
2025-04-15 12:19:05 [ERROR]: Copied 257 values for column: People
2025-04-15 12:19:05 [ERROR]: Copied 257 values for column: Places
2025-04-15 12:19:05 [ERROR]: Copied 257 values for column: Summary
2025-04-15 12:19:05 [ERROR]: Copied 257 values for column: Creation_Place
2025-04-15 12:19:05 [ERROR]: Single author specified: Angus Bethune
2025-04-15 12:19:05 [ERROR]: Citation specified: HBCA, B194-A-1
2025-04-15 12:19:05 [ERROR]: Starting date and place analysis sequence using preset: Sequence_Dates
2025-04-15 12:19:05 [ERROR]: Using required headers from sequential preset: ['Date', 'Place']
2025-04-15 12:19:05 [ERROR]: Clearing existing values for fresh date analysis
2025-04-15 12:19:05 [ERROR]: Copied existing Date values from compiled_df to date_df
2025-04-15 12:19:05 [ERROR]: Added legacy Creation_Place column to date_df
2025-04-15 12:19:05 [ERROR]: Created date analysis dataframe with 257 rows and columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-15 12:19:05 [ERROR]: Using specified sequential preset: Sequence_Dates
2025-04-15 12:19:05 [ERROR]: Found required headers in sequence preset: ['Date', 'Place']
2025-04-15 12:19:05 [ERROR]: Setting active sequential preset to: Sequence_Dates
2025-04-15 12:36:14 [ERROR]: Date analysis result dataframe has columns: ['Page', 'Text', 'Date', 'Place', 'Creation_Place']
2025-04-15 12:36:14 [ERROR]: Date analysis result dataframe has 257 rows
2025-04-15 12:36:14 [ERROR]: Date analysis found 227 dates
2025-04-15 12:36:14 [ERROR]: Date analysis found 227 Date values
2025-04-15 12:36:14 [ERROR]: Date analysis found 184 Place values
2025-04-15 12:36:14 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': "1824/09/01 Wednesday: Sultry weather a little rain in the forenoon. Recd the charge of the Post from Mr McBean. The engaged men of the Post are Amable Bienvenue, Phillibert Siccard, Charles De Lorme and Antoine Bourgoin. The porkeaters are Vital Mandeville, Francois Obuchon, Jean Bte Enfant, Joseph Pichette, Joseph De Sourrell, Michel Chatillon Pierre Gaudet & Antoine La Pertin. The discharged servants of the Post are Joseph Couture, and Martin Boulez; those from Lake Superior District are Louis St Jean Xavier Mettovie Amable Dupras and wife Clarke Hopk. Mr John Mc Intosh, John Taylor and Mr Lee Inman are here on business from Michippicotton. The gentlemen belonging to Lake Huron Department are John Mc Bean Esqr Messrs McKay Cowic, Varrie & Bourassa's. There is an old man Joseph La Verdure a freeman who is in the habit of jobbing about the Fort for his living There is no regular work for the men as yet being employed for the present in various jobs about the Fort. -", 'Date': '1824/09/01', 'Place': 'CHECK', 'Creation_Place': 'CHECK'}
2025-04-15 12:36:14 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': "1824/09/02 Thursday: Fine Weather. Amable Bienvenue at Smiths work Charles De Lorme was making up cordwood which had been cut last Winter, it amounts to 44 Cords. The old man La Verdure went to shew it to him. Siccard's duty is to attend to the Live Stock and the dairy Antoine Bourgoin employed as Cook and Domestic Mr McBean was packing up his Goods with a batteau load of which the Messrs Bourassas took their departure in the Afternoon The porkeaters remain unemployed at the Fort -", 'Date': '1824/09/02', 'Place': 'CHECK', 'Creation_Place': 'CHECK'}
2025-04-15 12:36:14 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '1824/09/03 Friday: Cloudy Weather at times, some rain last night and in forenoon The Blacksmith unwell today. The other men employed as yesterday Doctor Foote of the American Garrison was over on the forenoon on a visit Mr Chat. McKenjie and family arrived in the forenoon from Montreal in a North Canoe manned by four Iroquois and a Canadian Mr Mc Bean & his people were preparing for Lake Huron. Entered into engagements with two freemen for a month to square wood their names are Francois Sopier and Jean Bte Perrault. -', 'Date': '1824/09/03', 'Place': 'CHECK', 'Creation_Place': 'CHECK'}
2025-04-15 12:36:14 [ERROR]: Date analysis returned dataframe with columns: Page, Text, Date, Place, Creation_Place
2025-04-15 12:36:14 [ERROR]: Sample row 0: {'Page': np.int64(0), 'Text': "1824/09/01 Wednesday: Sultry weather a little rain in the forenoon. Recd the charge of the Post from Mr McBean. The engaged men of the Post are Amable Bienvenue, Phillibert Siccard, Charles De Lorme and Antoine Bourgoin. The porkeaters are Vital Mandeville, Francois Obuchon, Jean Bte Enfant, Joseph Pichette, Joseph De Sourrell, Michel Chatillon Pierre Gaudet & Antoine La Pertin. The discharged servants of the Post are Joseph Couture, and Martin Boulez; those from Lake Superior District are Louis St Jean Xavier Mettovie Amable Dupras and wife Clarke Hopk. Mr John Mc Intosh, John Taylor and Mr Lee Inman are here on business from Michippicotton. The gentlemen belonging to Lake Huron Department are John Mc Bean Esqr Messrs McKay Cowic, Varrie & Bourassa's. There is an old man Joseph La Verdure a freeman who is in the habit of jobbing about the Fort for his living There is no regular work for the men as yet being employed for the present in various jobs about the Fort. -", 'Date': '1824/09/01', 'Place': 'CHECK', 'Creation_Place': 'CHECK'}
2025-04-15 12:36:14 [ERROR]: Sample row 1: {'Page': np.int64(1), 'Text': "1824/09/02 Thursday: Fine Weather. Amable Bienvenue at Smiths work Charles De Lorme was making up cordwood which had been cut last Winter, it amounts to 44 Cords. The old man La Verdure went to shew it to him. Siccard's duty is to attend to the Live Stock and the dairy Antoine Bourgoin employed as Cook and Domestic Mr McBean was packing up his Goods with a batteau load of which the Messrs Bourassas took their departure in the Afternoon The porkeaters remain unemployed at the Fort -", 'Date': '1824/09/02', 'Place': 'CHECK', 'Creation_Place': 'CHECK'}
2025-04-15 12:36:14 [ERROR]: Sample row 2: {'Page': np.int64(2), 'Text': '1824/09/03 Friday: Cloudy Weather at times, some rain last night and in forenoon The Blacksmith unwell today. The other men employed as yesterday Doctor Foote of the American Garrison was over on the forenoon on a visit Mr Chat. McKenjie and family arrived in the forenoon from Montreal in a North Canoe manned by four Iroquois and a Canadian Mr Mc Bean & his people were preparing for Lake Huron. Entered into engagements with two freemen for a month to square wood their names are Francois Sopier and Jean Bte Perrault. -', 'Date': '1824/09/03', 'Place': 'CHECK', 'Creation_Place': 'CHECK'}
2025-04-15 12:36:14 [ERROR]: Using specified sequential preset for copying results: Sequence_Dates
2025-04-15 12:36:14 [ERROR]: Copying required headers from sequence preset: ['Date', 'Place']
2025-04-15 12:36:14 [ERROR]: Added missing Place column to compiled_df before copying results
2025-04-15 12:36:14 [ERROR]: Updated fields in the compiled dataframe: 227 Date, 184 Place, 184 Place_of_Creation, 184 Creation_Place
2025-04-15 12:36:14 [ERROR]: Sequential preset headers: ['Date', 'Place']
2025-04-15 12:36:14 [ERROR]: Preparing export dataframe. Text source: Original_Text
2025-04-15 12:36:14 [ERROR]: Using column 'Original_Text' for text
2025-04-15 12:36:14 [ERROR]: Overriding 'Author' column with single author: Angus Bethune
2025-04-15 12:36:14 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-15 12:36:14 [ERROR]: Adding/overwriting with sequential headers: ['Date', 'Place']
2025-04-15 12:36:14 [ERROR]: Adding 'Citation' column.
2025-04-15 12:36:14 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Place', 'Original_Text', 'Citation']
2025-04-15 14:18:22 [ERROR]: Error in ai_function orchestration for job Format_Text: name 'additional_info' is not defined
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\AIFunctions.py", line 395, in ai_function
    if additional_info:
       ^^^^^^^^^^^^^^^
NameError: name 'additional_info' is not defined
2025-04-15 14:33:09 [ERROR]: Resolved 'Current Display' to actual column: Separated_Text
2025-04-15 14:33:36 [ERROR]: Starting CSV export process
2025-04-15 14:33:36 [ERROR]: Ensuring these columns exist in the DataFrame: ['Page', 'Text', 'Citation', 'Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'People', 'Places', 'Translation', 'Separated_Text', 'Creation_Place', 'Date']
2025-04-15 14:33:36 [ERROR]: Added missing column: Text
2025-04-15 14:33:36 [ERROR]: Added missing column: Place_of_Creation
2025-04-15 14:33:36 [ERROR]: Using resolved text source column: Separated_Text
2025-04-15 14:33:36 [ERROR]: Reset index for temp_df. New length: 25
2025-04-15 14:34:03 [ERROR]: Restored original index to updated_df for alignment.
2025-04-15 14:34:03 [ERROR]: Using metadata headers from preset 'Standard Metadata': Document Type;Author;Correspondent;Correspondent Place;Date;Place of Creation;People;Places;Summary
2025-04-15 14:34:03 [ERROR]: Added essential column: Creation_Place
2025-04-15 14:34:03 [ERROR]: Metadata columns to copy: ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Creation_Place']
2025-04-15 14:34:03 [ERROR]: Copied 25 values for column: Document_Type
2025-04-15 14:34:03 [ERROR]: Copied 25 values for column: Author
2025-04-15 14:34:03 [ERROR]: Copied 25 values for column: Correspondent
2025-04-15 14:34:03 [ERROR]: Copied 25 values for column: Correspondent_Place
2025-04-15 14:34:03 [ERROR]: Copied 25 values for column: Date
2025-04-15 14:34:03 [ERROR]: Copied 25 values for column: Place_of_Creation
2025-04-15 14:34:03 [ERROR]: Copied 25 values for column: People
2025-04-15 14:34:03 [ERROR]: Copied 25 values for column: Places
2025-04-15 14:34:03 [ERROR]: Copied 25 values for column: Summary
2025-04-15 14:34:03 [ERROR]: Copied 25 values for column: Creation_Place
2025-04-15 14:34:03 [ERROR]: Single author specified: Angus Bethune
2025-04-15 14:34:03 [ERROR]: Citation specified: HBCA, B194-A-2
2025-04-15 14:34:03 [ERROR]: Starting date and place analysis sequence using preset: Sequence_Dates
2025-04-15 14:34:03 [ERROR]: Using required headers from sequential preset: ['Place']
2025-04-15 14:34:03 [ERROR]: Clearing existing values for fresh date analysis
2025-04-15 14:34:03 [ERROR]: Added legacy Creation_Place column to date_df
2025-04-15 14:34:03 [ERROR]: Created date analysis dataframe with 25 rows and columns: ['Page', 'Text', 'Place', 'Creation_Place']
2025-04-15 14:34:03 [ERROR]: Using specified sequential preset: Sequence_Dates
2025-04-15 14:34:03 [ERROR]: Found required headers in sequence preset: ['Place']
2025-04-15 14:34:03 [ERROR]: Setting active sequential preset to: Sequence_Dates
2025-04-15 14:34:43 [ERROR]: Date analysis result dataframe has columns: ['Page', 'Text', 'Place', 'Creation_Place']
2025-04-15 14:34:43 [ERROR]: Date analysis result dataframe has 25 rows
2025-04-15 14:34:43 [ERROR]: Error in asyncio loop: 'Date'
Stack trace:
Traceback (most recent call last):
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Date'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\ExportFunctions.py", line 1044, in _run_date_analysis
    date_count = sum(result['Date'].notna() & (result['Date'] != ""))
                     ~~~~~~^^^^^^^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Date'
2025-04-15 14:34:43 [ERROR]: Traceback: Traceback (most recent call last):
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Date'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\ExportFunctions.py", line 1044, in _run_date_analysis
    date_count = sum(result['Date'].notna() & (result['Date'] != ""))
                     ~~~~~~^^^^^^^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Date'

Stack trace:
Traceback (most recent call last):
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Date'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\ExportFunctions.py", line 1044, in _run_date_analysis
    date_count = sum(result['Date'].notna() & (result['Date'] != ""))
                     ~~~~~~^^^^^^^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Date'
2025-04-15 14:34:43 [ERROR]: Date and place analysis failed: invalid command name ".!toplevel15.!label"
Stack trace:
Traceback (most recent call last):
  File "c:\Programs\TranscriptionPearl\util\ExportFunctions.py", line 846, in _analyze_dates_sequentially
    progress_label.config(text="Finalizing date and place analysis...")
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\tkinter\__init__.py", line 1822, in configure
    return self._configure('configure', cnf, kw)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mark_\miniconda3\envs\PearlBot\Lib\tkinter\__init__.py", line 1812, in _configure
    self.tk.call(_flatten((self._w, cmd)) + self._options(cnf))
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_tkinter.TclError: invalid command name ".!toplevel15.!label"
2025-04-15 14:34:44 [ERROR]: Sequential preset headers: ['Place']
2025-04-15 14:34:44 [ERROR]: Preparing export dataframe. Text source: Separated_Text
2025-04-15 14:34:44 [ERROR]: Using column 'Separated_Text' for text
2025-04-15 14:34:44 [ERROR]: Dropped original text source column: Separated_Text
2025-04-15 14:34:44 [ERROR]: Overriding 'Author' column with single author: Angus Bethune
2025-04-15 14:34:44 [ERROR]: Metadata headers from preset 'Standard Metadata': ['Document_Type', 'Author', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary']
2025-04-15 14:34:44 [ERROR]: Adding/overwriting with sequential headers: ['Place']
2025-04-15 14:34:44 [ERROR]: Sequential header 'Place' not found in compiled data.
2025-04-15 14:34:44 [ERROR]: Adding 'Citation' column.
2025-04-15 14:34:44 [ERROR]: Final ordered columns for export: ['Page', 'Author', 'Document_Type', 'Correspondent', 'Correspondent_Place', 'Date', 'Place_of_Creation', 'People', 'Places', 'Summary', 'Original_Text', 'Citation']
